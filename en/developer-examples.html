<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta property="og:image" content="https://bitcoin.org/img/opengraph.png" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Developer Examples - Bitcoin</title>
<link rel="stylesheet" type="text/css" href="/a029ec6be4a42b1ffb2e134cb4040f2f.css" />
<!--[if lt IE 8]><link rel="stylesheet" type="text/css" href="/efc702a0aa79a2cda69eebe4befd4c11.css" /><script type="text/javascript" src="/js/ie.js"></script><![endif]-->


<script type="text/javascript" src="/js/main.js?1400954556"></script>
<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-touch-icon-precomposed" href="/img/logo_ios.png"/>
</head>
<body>
<div id="detectmobile" class="detectmobile"></div>


  <div class="head"><div>
    <ul class="lang">
      <li><a href="#" onclick="return false;">English</a>
      <ul>
        <li><ul>
        
        
        
          <li><a href="/id/">Bahasa Indonesia‬</a></li>
        
        
          <li><a href="/da/">Dansk</a></li>
        
        
          <li><a href="/de/">Deutsch</a></li>
        
        
          <li><a href="/en/" class="active">English</a></li>
        
        
          <li><a href="/es/">Español</a></li>
        
        
          <li><a href="/fr/">Français</a></li>
        
        
          <li><a href="/it/">Italiano</a></li>
        
        
          <li><a href="/hu/">magyar</a></li>
        
        
          <li><a href="/nl/">Nederlands</a></li>
        
        
          <li><a href="/pl/">polski</a></li>
        
        
          <li><a href="/pt_BR/">Português Brasil</a></li>
        
        
          <li><a href="/ro/">română</a></li>
        
        
          <li><a href="/sl/">slovenščina</a></li>
        
        </ul></li><li><ul>
          <li><a href="/sv/">Svenska</a></li>
        
        
          <li><a href="/tr/">Türkçe</a></li>
        
        
          <li><a href="/bg/">български</a></li>
        
        
          <li><a href="/ru/">Русский</a></li>
        
        
          <li><a href="/ar/">العربية</a></li>
        
        
          <li><a href="/fa/">فارسی</a></li>
        
        
          <li><a href="/hi/">हिन्दी</a></li>
        
        
          <li><a href="/ko/">한국의</a></li>
        
        
          <li><a href="/ja/">日本語</a></li>
        
        
          <li><a href="/zh_CN/">‪简体中文‬</a></li>
        
        
          <li><a href="/zh_TW/">‪繁體中文‬</a></li>
        
        </ul></li>
      </ul>
      </li>
    </ul>
    <a class="logo" href="/en/"><img src="/img/logotop.svg" alt="Bitcoin"></a>
    <a id="menumobile" class="menumobile" onclick="mobileMenuShow(event);" href="#"></a>
    <div id="langselect" class="langselect"><select onchange="window.location=this.value;">
    
          <option value="/id/">Bahasa Indonesia‬</option>
    
          <option value="/da/">Dansk</option>
    
          <option value="/de/">Deutsch</option>
    
          <option value="/en/" selected="selected">English</option>
    
          <option value="/es/">Español</option>
    
          <option value="/fr/">Français</option>
    
          <option value="/it/">Italiano</option>
    
          <option value="/hu/">magyar</option>
    
          <option value="/nl/">Nederlands</option>
    
          <option value="/pl/">polski</option>
    
          <option value="/pt_BR/">Português Brasil</option>
    
          <option value="/ro/">română</option>
    
          <option value="/sl/">slovenščina</option>
    
          <option value="/sv/">Svenska</option>
    
          <option value="/tr/">Türkçe</option>
    
          <option value="/bg/">български</option>
    
          <option value="/ru/">Русский</option>
    
          <option value="/ar/">العربية</option>
    
          <option value="/fa/">فارسی</option>
    
          <option value="/hi/">हिन्दी</option>
    
          <option value="/ko/">한국의</option>
    
          <option value="/ja/">日本語</option>
    
          <option value="/zh_CN/">‪简体中文‬</option>
    
          <option value="/zh_TW/">‪繁體中文‬</option>
    
    </select></div>
    <ul id="menusimple" class="menusimple" onclick="mobileMenuHover(event);">
      <li><a href="#" onclick="return false;">Introduction</a>
        <ul>
          <li><a href="/en/bitcoin-for-individuals">Individuals</a></li>
          <li><a href="/en/bitcoin-for-businesses">Businesses</a></li>
          <li><a href="/en/bitcoin-for-developers">Developers</a></li>
          
          <li><a href="/en/getting-started">Getting started</a></li>
          
          <li><a href="/en/how-it-works">How it works</a></li>
          <li><a href="/en/you-need-to-know">You need to know</a></li>
        </ul>
      </li>
      <li><a href="#" onclick="return false;">Resources</a>
        <ul>
          <li><a href="/en/resources">Resources</a></li>
          <li><a href="/en/community">Community</a></li>
          <li><a href="/en/developer-documentation">Documentation</a></li>
          <li><a href="/en/development">Development</a></li>
          <li><a href="/en/vocabulary">Vocabulary</a></li>
          
          <li><a href="/en/events">Events</a></li>
          
          <li><a href="/en/press">Press</a></li>
        </ul>
      </li>
      <li><a href="/en/innovation">Innovation</a></li>
      <li><a href="/en/support-bitcoin">Participate</a></li>
      
      <li><a href="/en/faq">FAQ</a></li>
      
    </ul>
  </div></div>
  <div class="body">
    <div id="content" class="content">
    <h1 id="bitcoin-developer-examples">Bitcoin Developer Examples</h1>

<p class="summary">Find examples of how to build programs using Bitcoin.</p>

<div id="toc" class="toc">
  <div>

<ul id="markdown-toc">
  <li><a href="#testing-applications">Testing Applications</a>    <ul>
      <li><a href="#testnet">Testnet</a></li>
      <li><a href="#regtest-mode">Regtest Mode</a></li>
    </ul>
  </li>
  <li><a href="#transactions">Transactions</a>    <ul>
      <li><a href="#transaction-tutorial">Transaction Tutorial</a>        <ul>
          <li><a href="#simple-spending">Simple Spending</a></li>
          <li><a href="#simple-raw-transaction">Simple Raw Transaction</a></li>
          <li><a href="#complex-raw-transaction">Complex Raw Transaction</a></li>
          <li><a href="#offline-signing">Offline Signing</a></li>
          <li><a href="#p2sh-multisig">P2SH Multisig</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#payment-processing">Payment Processing</a>    <ul>
      <li><a href="#payment-protocol">Payment Protocol</a>        <ul>
          <li><a href="#paymentrequest--paymentdetails">PaymentRequest &amp; PaymentDetails</a>            <ul>
              <li><a href="#initialization-code">Initialization Code</a></li>
              <li><a href="#configuration-code">Configuration Code</a></li>
              <li><a href="#code-variables">Code Variables</a></li>
              <li><a href="#derivable-data">Derivable Data</a></li>
              <li><a href="#output-code">Output Code</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

    <ul class="goback"><li><a href="/en/developer-documentation">Return To Overview</a></li></ul>
    <ul class="reportissue"><li><a href="https://github.com/bitcoin/bitcoin.org/issues/new" onmouseover="updateIssue(event);">Report An Issue</a></li></ul>

  </div>
</div>
<div class="toccontent">

  <!--Temporary disclaimer BEGIN-->
  <div id="develdocdisclaimer" class="develdocdisclaimer"><div>
<b>BETA</b>: This documentation has been written recently and still needs more reviews to ensure all content is covered correctly and accurately; if you find a mistake, please <a href="https://github.com/bitcoin/bitcoin.org/issues/new" onmouseover="updateIssue(event);">report an issue</a> on GitHub. <a href="#" onclick="disclaimerClose(event);">Click here</a> to close this disclaimer.
<a class="develdocdisclaimerclose" href="#" onclick="disclaimerClose(event);">X</a>
</div></div>
  <script>disclaimerAutoClose();</script>

  <!--Temporary disclaimer END-->

  <p>The following guide aims to provide examples to help you start
building Bitcoin-based applications. To make the best use of this document,
you may want to install the current version of Bitcoin Core, either from
<a href="https://github.com/bitcoin/bitcoin">source</a> or from a <a href="/en/download">pre-compiled executable</a>.</p>

  <p>Once installed, you’ll have access to three programs: <code>bitcoind</code>,
<code>bitcoin-qt</code>, and <code>bitcoin-cli</code>.</p>

  <ul>
    <li>
      <p><code>bitcoin-qt</code> provides a combination full Bitcoin <a href="/en/developer-guide#term-peer" title="Peer on the P2P network who receives and broadcasts transactions and blocks" class="auto-link">peer</a> and <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>
frontend. From the Help menu, you can access a console where you can
enter the <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> commands used throughout this document.</p>
    </li>
    <li>
      <p><code>bitcoind</code> is more useful for programming: it provides a full <a href="/en/developer-guide#term-peer" title="Peer on the P2P network who receives and broadcasts transactions and blocks" class="auto-link">peer</a>
which you can interact with through <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPCs</a> to port 8332 (or 18332
for <a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">testnet</a>).</p>
    </li>
    <li>
      <p><code>bitcoin-cli</code> allows you to send <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> commands to <code>bitcoind</code> from the
command line.  For example, <code>bitcoin-cli help</code></p>
    </li>
  </ul>

  <p>All three programs get settings from <code>bitcoin.conf</code> in the <code>Bitcoin</code>
application directory:</p>

  <ul>
    <li>
      <p>Windows: <code>%APPDATA%\Bitcoin\</code></p>
    </li>
    <li>
      <p>OSX: <code>$HOME/Library/Application Support/Bitcoin/</code></p>
    </li>
    <li>
      <p>Linux: <code>$HOME/.bitcoin/</code></p>
    </li>
  </ul>

  <p>To use <code>bitcoind</code> and <code>bitcoin-cli</code>, you will need to add a <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> password
to your <code>bitcoin.conf</code> file. Both programs will read from the same file
if both run on the same system as the same user, so any long random
password will work:</p>

  <pre><code>rpcpassword=change_this_to_a_long_random_password
</code></pre>

  <p>You should also make the <code>bitcoin.conf</code> file only readable to its
owner.  On Linux, Mac OSX, and other Unix-like systems, this can be
accomplished by running the following command in the Bitcoin application
directory:</p>

  <pre><code>chmod 0600 bitcoin.conf
</code></pre>

  <p>For development, it’s safer and cheaper to use Bitcoin’s test <a href="/en/developer-guide#term-network" title="The Bitcoin P2P network which broadcasts transactions and blocks" class="auto-link">network</a> (<a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">testnet</a>)
or <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regression test mode</a> (<a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a>) described below.</p>

  <p>Questions about Bitcoin development are best sent to the Bitcoin <a href="https://bitcointalk.org/index.php?board=4.0">Forum</a> and <a href="https://en.bitcoin.it/wiki/IRC_channels">IRC channels</a>. Errors or suggestions related to
documentation on Bitcoin.org can be <a href="https://github.com/bitcoin/bitcoin.org/issues">submitted as an issue</a>
or posted to the <a href="https://groups.google.com/forum/#!forum/bitcoin-documentation">bitcoin-documentation mailing list</a>.</p>

  <p>In the following documentation, some strings have been shortened or wrapped: “[…]”
indicates extra data was removed, and lines ending in a single backslash “\”
are continued below. If you hover your mouse over a paragraph, cross-reference
links will be shown in blue.  If you hover over a cross-reference link, a brief
definition of the term will be displayed in a tooltip.</p>

  <h2 id="testing-applications">Testing Applications</h2>

  <p>Bitcoin Core provides testing tools designed to let developers
test their applications with reduced risks and limitations.</p>

  <h3 id="testnet">Testnet</h3>

  <p>When run with no arguments, all Bitcoin Core programs default to Bitcoin’s main
<a href="/en/developer-guide#term-network" title="The Bitcoin P2P network which broadcasts transactions and blocks" class="auto-link">network</a> (<a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" id="term-mainnet" class="term">mainnet</a>). However, for development,
it’s safer and cheaper to use Bitcoin’s test <a href="/en/developer-guide#term-network" title="The Bitcoin P2P network which broadcasts transactions and blocks" class="auto-link">network</a> (<a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">testnet</a>)
where the <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> spent have no real-world value. <a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">Testnet</a> also relaxes some
restrictions (such as <a href="/en/developer-guide#standard-transactions" title="An output script which matches the isStandard() patterns specified in Bitcoin Core---or a transaction containing only standard outputs. Only standard transactions are mined or broadcast by peers running the default Bitcoin Core software" class="auto-link">standard transaction</a> checks) so you can test functions
which might currently be disabled by default on <a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a>.</p>

  <p>To use <a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">testnet</a>, use the argument <code>-testnet</code> with <code>bitcoin-cli</code>, <code>bitcoind</code> or <code>bitcoin-qt</code> or add
<code>testnet=1</code> to your <code>bitcoin.conf</code> file.  To get
free <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> for testing, use <a href="https://tpfaucet.appspot.com/">Piotr Piasecki’s testnet faucet</a>.
<a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">Testnet</a> is a public resource provided for free by members of the
community, so please don’t abuse it.</p>

  <h3 id="regtest-mode">Regtest Mode</h3>

  <p>For situations
where interaction with random <a href="/en/developer-guide#term-peer" title="Peer on the P2P network who receives and broadcasts transactions and blocks" class="auto-link">peers</a> and <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">blocks</a> is unnecessary or
unwanted, Bitcoin Core’s <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regression test mode</a> (<a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a> mode) lets you
instantly create a brand-new private <a href="/en/developer-guide#block-chain" title="A chain of blocks with each block linking to the block that preceded; the most-difficult-to-recreate chain is The Block Chain" class="auto-link">block chain</a> with the same basic
rules as <a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">testnet</a>—but one major difference: you choose when to create
new <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">blocks</a>, so you have complete control over the environment.</p>

  <p>Many developers consider <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a> mode the preferred way to develop new
applications. The following example will let you create a <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a>
environment.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoind -regtest -daemon
Bitcoin server starting
</code></pre>
</div>

  <p>Start <code>bitcoind</code> in <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a> mode to create a private <a href="/en/developer-guide#block-chain" title="A chain of blocks with each block linking to the block that preceded; the most-difficult-to-recreate chain is The Block Chain" class="auto-link">block chain</a>.</p>

  <pre><code>bitcoin-cli -regtest setgenerate true 101
</code></pre>

  <p>Generate 101 <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">blocks</a> using a special version of the <a href="/en/developer-reference#setgenerate" class="auto-link"><code>setgenerate</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a>
which is only available in <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a> mode. This takes about 30 seconds on
a generic PC. Because this is a new <a href="/en/developer-guide#block-chain" title="A chain of blocks with each block linking to the block that preceded; the most-difficult-to-recreate chain is The Block Chain" class="auto-link">block chain</a> using Bitcoin’s default
rules, the first 210,000 <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">blocks</a> pay a <a href="/en/developer-reference#term-block-reward" title="New satoshis given to a miner for creating one of the first 6,929,999 blocks" class="auto-link">block reward</a> of 50 <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a>.
However, a <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> must have 100 <a href="/en/developer-guide#term-confirmation" title="The number of blocks which would need to be modified to remove or modify a transaction" class="auto-link">confirmations</a> before that reward can be
spent, so we generate 101 <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">blocks</a> to get access to the <a href="/en/developer-reference#term-coinbase-tx" title="A special transaction which miners must create when they generate a block" class="auto-link">coinbase
transaction</a> from <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> #1.</p>

  <div class="highlight"><pre><code class="bash">bitcoin-cli -regtest getbalance
50.00000000
</code></pre>
</div>

  <p>Verify that we now have 50 <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a> available to spend.</p>

  <p>You can now use Bitcoin Core <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPCs</a> prefixed with <code>bitcoin-cli -regtest</code>.</p>

  <p><a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">Regtest</a> <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallets</a> and <a href="/en/developer-guide#block-chain" title="A chain of blocks with each block linking to the block that preceded; the most-difficult-to-recreate chain is The Block Chain" class="auto-link">block chain</a> state (chainstate) are saved in the <code>regtest</code>
subdirectory of the Bitcoin Core configuration directory. You can safely
delete the <code>regtest</code> subdirectory and restart Bitcoin Core to
start a new <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a>. (See the <a href="/en/developer-examples">Developer Examples Introduction</a> for default
configuration directory locations on various operating systems. Always back up
<a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a> <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallets</a> before performing dangerous operations such as deleting.)</p>

  <h2 id="transactions">Transactions</h2>

  <h3 id="transaction-tutorial">Transaction Tutorial</h3>

  <p>Creating transactions is something most Bitcoin applications do.
This section describes how to use Bitcoin Core’s <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> interface to
create transactions with various attributes.</p>

  <p>Your applications may use something besides Bitcoin Core to create
transactions, but in any system, you will need to provide the same kinds
of data to create transactions with the same attributes as those
described below.</p>

  <p>In order to use this tutorial, you will need to setup <a href="/en/download">Bitcoin Core</a>
and create a <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks">regression test mode</a> environment with 50 BTC in your test
<a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>.</p>

  <h4 id="simple-spending">Simple Spending</h4>

  <p>Bitcoin Core provides several <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPCs</a> which handle all the details of
spending, including creating <a href="/en/developer-guide#term-change-output" title="An output used by a spender to send back to himself some of the satoshis from the inputs" class="auto-link">change outputs</a> and paying appropriate fees.
Even advanced users should use these <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPCs</a> whenever possible to decrease
the chance that <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> will be lost by mistake.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest getnewaddress
mvbnrCX3bg1cDRUu8pkecrvP6vQkSLDSou

&gt; <span class="nv">NEW_ADDRESS</span><span class="o">=</span>mvbnrCX3bg1cDRUu8pkecrvP6vQkSLDSou
</code></pre>
</div>

  <p>Get a new Bitcoin <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> and save it in the shell variable <code>$NEW_ADDRESS</code>.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest sendtoaddress <span class="nv">$NEW_ADDRESS</span> 10.00
263c018582731ff54dc72c7d67e858c002ae298835501d80200f05753de0edf0
</code></pre>
</div>

  <p>Send 10 <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a> to the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> using the <a href="/en/developer-reference#sendtoaddress" class="auto-link"><code>sendtoaddress</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a>.  The
returned hex string is the transaction identifier (<a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a>).</p>

  <p>The <a href="/en/developer-reference#sendtoaddress" class="auto-link"><code>sendtoaddress</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> automatically selects an unspent transaction
<a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> (<a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a>) from which to spend the <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a>. In this case, it
withdrew the <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> from our only available <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a>, the <a href="/en/developer-reference#term-coinbase-tx" title="A special transaction which miners must create when they generate a block" class="auto-link">coinbase
transaction</a> for <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> #1 which matured with the creation of <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> #101.
To spend a specific <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a>, you could use the <a href="/en/developer-reference#sendfrom" class="auto-link"><code>sendfrom</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> instead.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest listunspent
<span class="o">[</span>
<span class="o">]</span>
</code></pre>
</div>

  <p>Use the <a href="/en/developer-reference#listunspent" class="auto-link"><code>listunspent</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> to display the <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a> belonging to this <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>.
The list is empty because it defaults to only showing <a href="/en/developer-guide#term-confirmation" title="A transaction included in a block currently on the block chain" class="auto-link">confirmed</a>
<a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a> and we just spent our only <a href="/en/developer-guide#term-confirmation" title="A transaction included in a block currently on the block chain" class="auto-link">confirmed</a> <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a>.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest listunspent 0
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835501d\</span>
<span class="s2">                  80200f05753de0edf0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;muhtvdmsnbQEPFuEmxcChX58fGvXaaUoVt&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a9149ba386253ea698158b6d34802bb9b550\</span>
<span class="s2">                          f5ce36dd88ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">40.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835501d\</span>
<span class="s2">                  80200f05753de0edf0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;mvbnrCX3bg1cDRUu8pkecrvP6vQkSLDSou&quot;</span><span class="p">,</span>
        <span class="nt">&quot;account&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a914a57414e5ffae9ef5074bacbe10a320bb\</span>
<span class="s2">                          2614e1f388ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">10.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">]</span>
</code></pre>
</div>

  </div>

  <p>Re-running the <a href="/en/developer-reference#listunspent" class="auto-link"><code>listunspent</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> with the argument “0” to also display
<a href="/en/developer-guide#term-unconfirmed-transactions" title="A transaction which has not yet been added to the block chain" class="auto-link">unconfirmed transactions</a> shows that we have two <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a>, both with the
same <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a>. The first <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> shown is a <a href="/en/developer-guide#term-change-output" title="An output used by a spender to send back to himself some of the satoshis from the inputs" class="auto-link">change output</a> that <a href="/en/developer-reference#sendtoaddress" class="auto-link"><code>sendtoaddress</code></a>
created using a new <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> from the key pool. The second <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> shown is
the spend to the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> we provided. If we had spent those <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> to
someone else, that second transaction would not be displayed in our
list of <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a>.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest setgenerate <span class="nb">true </span>1

&gt; <span class="nb">unset </span>NEW_ADDRESS
</code></pre>
</div>

  <p>Create a new <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> to <a href="/en/developer-guide#term-confirmation" title="A transaction included in a block currently on the block chain" class="auto-link">confirm</a> the transaction above (takes less than a
second) and clear the shell variable.</p>

  <h4 id="simple-raw-transaction">Simple Raw Transaction</h4>

  <p>The raw transaction <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPCs</a> allow users to create custom transactions and
delay <a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner)" class="auto-link">broadcasting</a> those transactions. However, mistakes made in raw
transactions may not be detected by Bitcoin Core, and a number of raw
transaction users have permanently lost large numbers of <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a>, so
please be careful using raw transactions on <a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a>.</p>

  <p>This subsection covers one of the simplest possible raw transactions.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest listunspent
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835501d\</span>
<span class="s2">                  80200f05753de0edf0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;muhtvdmsnbQEPFuEmxcChX58fGvXaaUoVt&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a9149ba386253ea698158b6d34802bb9b550\</span>
<span class="s2">                          f5ce36dd88ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">40.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835501d\</span>
<span class="s2">                  80200f05753de0edf0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;mvbnrCX3bg1cDRUu8pkecrvP6vQkSLDSou&quot;</span><span class="p">,</span>
        <span class="nt">&quot;account&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a914a57414e5ffae9ef5074bacbe10a320bb\</span>
<span class="s2">                          2614e1f388ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">10.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;3f4fa19803dec4d6a84fae3821da7ac7577080ef754512\</span>
<span class="s2">                  94e71f9b20e0ab1e7b&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;mwJTL1dZG8BAP6X7Be3CNNcuVKi7Qqt7Gk&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;210260a275cccf0f4b106220725be516adba27\</span>
<span class="s2">                          52db1bec8c5b7174c89c4c07891f88ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">50.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">101</span>
    <span class="p">}</span>
<span class="p">]</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">UTXO_TXID</span><span class="o">=</span>3f4fa19803dec4d6a84fae3821da7ac7577080ef75451294e71f<span class="o">[</span>...<span class="o">]</span>
&gt; <span class="nv">UTXO_VOUT</span><span class="o">=</span>0
</code></pre>
</div>

  </div>

  <p>Re-rerun <a href="/en/developer-reference#listunspent" class="auto-link"><code>listunspent</code></a>. We now have three <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a>: the two transactions we
created before plus the <a href="/en/developer-reference#term-coinbase-tx" title="A special transaction which miners must create when they generate a block" class="auto-link">coinbase transaction</a> from <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> #2. We save the
<a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a> and <a href="/en/developer-guide#term-output-index" title="The sequentially-numbered index of outputs in a single transaction starting from 0" class="auto-link">output index</a> number (vout) of that <a href="/en/developer-reference#term-coinbase-tx" title="A special transaction which miners must create when they generate a block" class="auto-link">coinbase</a> <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> to shell
variables.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest getnewaddress
mz6KvC4aoUeo6wSxtiVQTo7FDwPnkp6URG

&gt; <span class="nv">NEW_ADDRESS</span><span class="o">=</span>mz6KvC4aoUeo6wSxtiVQTo7FDwPnkp6URG
</code></pre>
</div>

  <p>Get a new <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> to use in the raw transaction.</p>

  <div class="highlight"><pre><code class="bash"><span class="c">## Outputs - inputs = transaction fee, so always double-check your math!</span>
&gt; bitcoin-cli -regtest createrawtransaction <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO_TXID</span><span class="s1">&#39;&quot;,</span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO_VOUT</span><span class="s1">&#39;</span>
<span class="s1">      }</span>
<span class="s1">    ]</span>
<span class="s1">    &#39;&#39;&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    {</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS</span><span class="s1">&#39;&quot;: 49.9999</span>
<span class="s1">    }&#39;&#39;&#39;</span>
01000000017b1eabe0209b1fe794124575ef807057c77ada2138ae4fa8d6c4de<span class="se">\</span>
0398a14f3f0000000000ffffffff01f0ca052a010000001976a914cbc20a7664<span class="se">\</span>
f2f69e5355aa427045bc15e7c6c77288ac00000000

&gt; <span class="nv">RAW_TX</span><span class="o">=</span>01000000017b1eabe0209b1fe794124575ef807057c77ada2138ae4<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>Using two arguments to the <a href="/en/developer-reference#createrawtransaction" class="auto-link"><code>createrawtransaction</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a>, we create a new
<a href="/en/developer-reference#term-raw-format" title="Complete transactions in their binary format; often represented using hexidecimal" class="auto-link">raw format</a> transaction. The first argument (a JSON array) references
the <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a> of the <a href="/en/developer-reference#term-coinbase-tx" title="A special transaction which miners must create when they generate a block" class="auto-link">coinbase transaction</a> from <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> #2 and the index
number (0) of the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> from that transaction we want to spend. The
second argument (a JSON object) creates the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> with the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>
(<a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public key</a> hash) and number of <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a> we want to transfer.
We save the resulting <a href="/en/developer-reference#term-raw-format" title="Complete transactions in their binary format; often represented using hexidecimal" class="auto-link">raw format</a> transaction to a shell variable.</p>

  <p><img src="/img/icon_warning.svg" alt="Warning icon" />
 <strong>Warning:</strong> <a href="/en/developer-reference#createrawtransaction" class="auto-link"><code>createrawtransaction</code></a> does not automatically create <a href="/en/developer-guide#term-change-output" title="An output used by a spender to send back to himself some of the satoshis from the inputs" class="auto-link">change
outputs</a>, so you can easily accidentally pay a large <a href="/en/developer-guide#term-transaction-fee" title="The amount remaining when all outputs are subtracted from all inputs in a transaction; the fee is paid to the miner who includes that transaction in a block" class="auto-link">transaction fee</a>. In
this example, our <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">input</a> had 50.0000 <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a> and our <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a>
(<code>$NEW_ADDRESS</code>) is being paid 49.9999 <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a>, so the transaction will
include a fee of 0.0001 <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a>. If we had paid <code>$NEW_ADDRESS</code> only 10
<a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a> with no other changes to this transaction, the <a href="/en/developer-guide#term-transaction-fee" title="The amount remaining when all outputs are subtracted from all inputs in a transaction; the fee is paid to the miner who includes that transaction in a block" class="auto-link">transaction fee</a>
would be a whopping 40 <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a>. See the Complex Raw Transaction
subsection below for how to create a transaction with multiple <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">outputs</a> so you
can send the change back to yourself.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest decoderawtransaction <span class="nv">$RAW_TX</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;c80b343d2ce2b5d829c2de9854c7c8d423c0e33bda264c4013\</span>
<span class="s2">              8d834aab4c0638&quot;</span><span class="p">,</span>
    <span class="nt">&quot;version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;locktime&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;vin&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;3f4fa19803dec4d6a84fae3821da7ac7577080ef75\</span>
<span class="s2">                      451294e71f9b20e0ab1e7b&quot;</span><span class="p">,</span>
            <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;scriptSig&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;sequence&quot;</span> <span class="p">:</span> <span class="mi">4294967295</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mf">49.99990000</span><span class="p">,</span>
            <span class="nt">&quot;n&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;OP_DUP OP_HASH160 cbc20a7664f2f69e5355a\</span>
<span class="s2">                         a427045bc15e7c6c772 OP_EQUALVERIFY OP_CHECKSIG&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a914cbc20a7664f2f69e5355aa427045bc15e\</span>
<span class="s2">                         7c6c77288ac&quot;</span><span class="p">,</span>
                <span class="nt">&quot;reqSigs&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;pubkeyhash&quot;</span><span class="p">,</span>
                <span class="nt">&quot;addresses&quot;</span> <span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;mz6KvC4aoUeo6wSxtiVQTo7FDwPnkp6URG&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre>
</div>

  </div>

  <p>Use the <a href="/en/developer-reference#decoderawtransaction" class="auto-link"><code>decoderawtransaction</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> to see exactly what the transaction
we just created does.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest signrawtransaction <span class="nv">$RAW_TX</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;01000000017b1eabe0209b1fe794124575ef807057c77ada213\</span>
<span class="s2">             8ae4fa8d6c4de0398a14f3f00000000494830450221008949f0\</span>
<span class="s2">             cb400094ad2b5eb399d59d01c14d73d8fe6e96df1a7150deb38\</span>
<span class="s2">             8ab8935022079656090d7f6bac4c9a94e0aad311a4268e082a7\</span>
<span class="s2">             25f8aeae0573fb12ff866a5f01ffffffff01f0ca052a0100000\</span>
<span class="s2">             01976a914cbc20a7664f2f69e5355aa427045bc15e7c6c77288\</span>
<span class="s2">             ac00000000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;complete&quot;</span> <span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">SIGNED_RAW_TX</span><span class="o">=</span>01000000017b1eabe0209b1fe794124575ef807057c77ada<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>Use the <a href="/en/developer-reference#signrawtransaction" class="auto-link"><code>signrawtransaction</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> to sign the transaction created by
<a href="/en/developer-reference#createrawtransaction" class="auto-link"><code>createrawtransaction</code></a> and save the returned “hex” <a href="/en/developer-reference#term-raw-format" title="Complete transactions in their binary format; often represented using hexidecimal" class="auto-link">raw format</a> signed
transaction to a shell variable. </p>

  <p>Even though the transaction is now complete, the Bitcoin Core node we’re
connected to doesn’t know anything about the transaction, nor does any
other part of the <a href="/en/developer-guide#term-network" title="The Bitcoin P2P network which broadcasts transactions and blocks" class="auto-link">network</a>. We’ve created a spend, but we haven’t
actually spent anything because we could simply unset the
<code>$SIGNED_RAW_TX</code> variable to eliminate the transaction.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest sendrawtransaction <span class="nv">$SIGNED_RAW_TX</span>
c7736a0a0046d5a8cc61c8c3c2821d4d7517f5de2bc66a966011aaa79965ffba
</code></pre>
</div>

  <p>Send the signed transaction to the connected node using the
<a href="/en/developer-reference#sendrawtransaction" class="auto-link"><code>sendrawtransaction</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a>. After accepting the transaction, the node
would usually then <a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner" class="auto-link">broadcast</a> it to other <a href="/en/developer-guide#term-peer" title="Peer on the P2P network who receives and broadcasts transactions and blocks" class="auto-link">peers</a>, but we’re not currently
connected to other <a href="/en/developer-guide#term-peer" title="Peer on the P2P network who receives and broadcasts transactions and blocks" class="auto-link">peers</a> because we started in <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a> mode.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest setgenerate <span class="nb">true </span>1

&gt; <span class="nb">unset </span>UTXO_TXID UTXO_VOUT NEW_ADDRESS RAW_TX SIGNED_RAW_TX
</code></pre>
</div>

  <p>Generate a <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a> to <a href="/en/developer-guide#term-confirmation" title="A transaction included in a block currently on the block chain" class="auto-link">confirm</a> the transaction and clear our shell
variables.</p>

  <h4 id="complex-raw-transaction">Complex Raw Transaction</h4>

  <p>In this example, we’ll create a transaction with two <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a> and two
<a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">outputs</a>.  We’ll sign each of the <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a> separately, as might happen if
the two <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a> belonged to different people who agreed to create a
transaction together (such as a CoinJoin transaction).</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest listunspent
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835501d\</span>
<span class="s2">                  80200f05753de0edf0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;muhtvdmsnbQEPFuEmxcChX58fGvXaaUoVt&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a9149ba386253ea698158b6d34802bb9b550\</span>
<span class="s2">                          f5ce36dd88ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">40.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">2</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835501d\</span>
<span class="s2">                  80200f05753de0edf0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;mvbnrCX3bg1cDRUu8pkecrvP6vQkSLDSou&quot;</span><span class="p">,</span>
        <span class="nt">&quot;account&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a914a57414e5ffae9ef5074bacbe10a320bb\</span>
<span class="s2">                          2614e1f388ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">10.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">2</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;78203a8f6b529693759e1917a1b9f05670d036fbb12911\</span>
<span class="s2">                  0ed26be6a36de827f3&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;n2KprMQm4z2vmZnPMENfbp2P1LLdAEFRjS&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;210229688a74abd0d5ad3b06ddff36fa9cd8ed\</span>
<span class="s2">                          d181d97b9489a6adc40431fb56e1d8ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">50.00000000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">101</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;c7736a0a0046d5a8cc61c8c3c2821d4d7517f5de2bc66a\</span>
<span class="s2">                  966011aaa79965ffba&quot;</span><span class="p">,</span>
        <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;mz6KvC4aoUeo6wSxtiVQTo7FDwPnkp6URG&quot;</span><span class="p">,</span>
        <span class="nt">&quot;account&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a914cbc20a7664f2f69e5355aa427045bc15\</span>
<span class="s2">                          e7c6c77288ac&quot;</span><span class="p">,</span>
        <span class="nt">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">49.99990000</span><span class="p">,</span>
        <span class="nt">&quot;confirmations&quot;</span> <span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">]</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">UTXO1_TXID</span><span class="o">=</span>78203a8f6b529693759e1917a1b9f05670d036fbb129110ed26<span class="o">[</span>...<span class="o">]</span>
&gt; <span class="nv">UTXO1_VOUT</span><span class="o">=</span>0
&gt; <span class="nv">UTXO1_ADDRESS</span><span class="o">=</span>n2KprMQm4z2vmZnPMENfbp2P1LLdAEFRjS
 
&gt; <span class="nv">UTXO2_TXID</span><span class="o">=</span>263c018582731ff54dc72c7d67e858c002ae298835501d80200<span class="o">[</span>...<span class="o">]</span>
&gt; <span class="nv">UTXO2_VOUT</span><span class="o">=</span>0
&gt; <span class="nv">UTXO2_ADDRESS</span><span class="o">=</span>muhtvdmsnbQEPFuEmxcChX58fGvXaaUoVt
</code></pre>
</div>

  </div>

  <p>For our two <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a>, we select two <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a> by placing the <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a> and <a href="/en/developer-guide#term-output-index" title="The sequentially-numbered index of outputs in a single transaction starting from 0" class="auto-link">output
index</a> numbers (vouts) in shell variables.  We also save the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a>
corresponding to the <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> (hashed or unhashed) used in those
transactions. We need the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> so we can get the corresponding
<a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> from our <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest dumpprivkey <span class="nv">$UTXO1_ADDRESS</span>
cSp57iWuu5APuzrPGyGc4PGUeCg23PjenZPBPoUs24HtJawccHPm

&gt; bitcoin-cli -regtest dumpprivkey <span class="nv">$UTXO2_ADDRESS</span>
cT26DX6Ctco7pxaUptJujRfbMS2PJvdqiSMaGaoSktHyon8kQUSg

&gt; <span class="nv">UTXO1_PRIVATE_KEY</span><span class="o">=</span>cSp57iWuu5APuzrPGyGc4PGUeCg23PjenZPBPoUs24Ht<span class="o">[</span>...<span class="o">]</span>

&gt; <span class="nv">UTXO2_PRIVATE_KEY</span><span class="o">=</span>cT26DX6Ctco7pxaUptJujRfbMS2PJvdqiSMaGaoSktHy<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>Use the <a href="/en/developer-reference#dumpprivkey" class="auto-link"><code>dumpprivkey</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> to get the <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> corresponding to the
<a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> used in the two <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a> out <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a> we will be spending.  We need
the <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> so we can sign each of the <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a> separately.</p>

  <p><img src="/img/icon_warning.svg" alt="Warning icon" />
 <strong>Warning:</strong> Users should never manually manage <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> on <a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a>.
As dangerous as raw transactions are (see warnings above), making a
mistake with a <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private key</a> can be much worse—as in the case of a HD
<a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> <a href="/en/developer-guide#hardened-keys">cross-generational key compromise</a>.
These examples are to help you learn, not for you to emulate on
<a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a>.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest getnewaddress
n4puhBEeEWD2VvjdRC9kQuX2abKxSCMNqN
&gt; bitcoin-cli -regtest getnewaddress
n4LWXU59yM5MzQev7Jx7VNeq1BqZ85ZbLj

&gt; <span class="nv">NEW_ADDRESS1</span><span class="o">=</span>n4puhBEeEWD2VvjdRC9kQuX2abKxSCMNqN
&gt; <span class="nv">NEW_ADDRESS2</span><span class="o">=</span>n4LWXU59yM5MzQev7Jx7VNeq1BqZ85ZbLj
</code></pre>
</div>

  <p>For our two <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">outputs</a>, get two new <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a>.</p>

  <div class="highlight"><pre><code class="bash"><span class="c">## Outputs - inputs = transaction fee, so always double-check your math!</span>
&gt; bitcoin-cli -regtest createrawtransaction <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO1_TXID</span><span class="s1">&#39;&quot;, </span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO1_VOUT</span><span class="s1">&#39;</span>
<span class="s1">      }, </span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO2_TXID</span><span class="s1">&#39;&quot;,</span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO2_VOUT</span><span class="s1">&#39;</span>
<span class="s1">      }</span>
<span class="s1">    ]</span>
<span class="s1">    &#39;&#39;&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    {</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS1</span><span class="s1">&#39;&quot;: 79.9999, </span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS2</span><span class="s1">&#39;&quot;: 10 </span>
<span class="s1">    }&#39;&#39;&#39;</span>
0100000002f327e86da3e66bd20e1129b1fb36d07056f0b9a117199e75939652<span class="se">\</span>
6b8f3a20780000000000fffffffff0ede03d75050f20801d50358829ae02c058<span class="se">\</span>
e8677d2cc74df51f738285013c260000000000ffffffff02f028d6dc01000000<span class="se">\</span>
1976a914ffb035781c3c69e076d48b60c3d38592e7ce06a788ac00ca9a3b0000<span class="se">\</span>
00001976a914fa5139067622fd7e1e722a05c17c2bb7d5fd6df088ac00000000

&gt; <span class="nv">RAW_TX</span><span class="o">=</span>0100000002f327e86da3e66bd20e1129b1fb36d07056f0b9a117199<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>Create the raw transaction using <a href="/en/developer-reference#createrawtransaction" class="auto-link"><code>createrawtransaction</code></a> much the same as
before, except now we have two <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a> and two <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">outputs</a>.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest signrawtransaction <span class="nv">$RAW_TX</span> <span class="s1">&#39;[]&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$UTXO1_PRIVATE_KEY</span><span class="s1">&#39;&quot;</span>
<span class="s1">    ]&#39;&#39;&#39;</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;0100000002f327e86da3e66bd20e1129b1fb36d07056f0b9a11\</span>
<span class="s2">             7199e759396526b8f3a20780000000049483045022100fce442\</span>
<span class="s2">             ec52aa2792efc27fd3ad0eaf7fa69f097fdcefab017ea56d179\</span>
<span class="s2">             9b10b2102207a6ae3eb61e11ffaba0453f173d1792f1b7bb8e7\</span>
<span class="s2">             422ea945101d68535c4b474801fffffffff0ede03d75050f208\</span>
<span class="s2">             01d50358829ae02c058e8677d2cc74df51f738285013c260000\</span>
<span class="s2">             000000ffffffff02f028d6dc010000001976a914ffb035781c3\</span>
<span class="s2">             c69e076d48b60c3d38592e7ce06a788ac00ca9a3b0000000019\</span>
<span class="s2">             76a914fa5139067622fd7e1e722a05c17c2bb7d5fd6df088ac0\</span>
<span class="s2">             0000000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;complete&quot;</span> <span class="p">:</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">PARTLY_SIGNED_RAW_TX</span><span class="o">=</span>0100000002f327e86da3e66bd20e1129b1fb36d07<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>Signing the raw transaction with <a href="/en/developer-reference#signrawtransaction" class="auto-link"><code>signrawtransaction</code></a> gets more
complicated as we now have three arguments:</p>

  <ol>
    <li>
      <p>The unsigned raw transaction.</p>
    </li>
    <li>
      <p>An empty array. We don’t do anything with this argument in this
operation, but some valid JSON must be provided to get access to the
later positional arguments.</p>
    </li>
    <li>
      <p>The <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private key</a> we want to use to sign one of the <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a>.</p>
    </li>
  </ol>

  <p>The result is a raw transaction with only one <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">input</a> signed; the fact
that the transaction isn’t fully signed is indicated by value of the
<code>complete</code> JSON field.  We save the incomplete, partly-signed raw
transaction hex to a shell variable.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest signrawtransaction <span class="nv">$PARTLY_SIGNED_RAW_TX</span> <span class="s1">&#39;[]&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$UTXO2_PRIVATE_KEY</span><span class="s1">&#39;&quot;</span>
<span class="s1">    ]&#39;&#39;&#39;</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;0100000002f327e86da3e66bd20e1129b1fb36d07056f0b9a11\</span>
<span class="s2">             7199e759396526b8f3a20780000000049483045022100fce442\</span>
<span class="s2">             ec52aa2792efc27fd3ad0eaf7fa69f097fdcefab017ea56d179\</span>
<span class="s2">             9b10b2102207a6ae3eb61e11ffaba0453f173d1792f1b7bb8e7\</span>
<span class="s2">             422ea945101d68535c4b474801fffffffff0ede03d75050f208\</span>
<span class="s2">             01d50358829ae02c058e8677d2cc74df51f738285013c260000\</span>
<span class="s2">             00006b483045022100b77f935ff366a6f3c2fdeb83589c79026\</span>
<span class="s2">             5d43b3d2cf5e5f0047da56c36de75f40220707ceda75d8dcf2c\</span>
<span class="s2">             caebc506f7293c3dcb910554560763d7659fb202f8ec324b012\</span>
<span class="s2">             102240d7d3c7aad57b68aa0178f4c56f997d1bfab2ded3c2f94\</span>
<span class="s2">             27686017c603a6d6ffffffff02f028d6dc010000001976a914f\</span>
<span class="s2">             fb035781c3c69e076d48b60c3d38592e7ce06a788ac00ca9a3b\</span>
<span class="s2">             000000001976a914fa5139067622fd7e1e722a05c17c2bb7d5f\</span>
<span class="s2">             d6df088ac00000000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;complete&quot;</span> <span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>
</div>

  </div>

  <p>To sign the second <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">input</a>, we repeat the process we used to sign the
first <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">input</a> using the second <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private key</a>. Now that both <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a> are
signed, the <code>complete</code> result is <em>true</em>.</p>

  <div class="highlight"><pre><code class="bash">&gt; <span class="nb">unset </span>PARTLY_SIGNED_RAW_TX RAW_TX NEW_ADDRESS1 <span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>Clean up the shell variables used. Unlike previous subsections, we’re
not going to send this transaction to the connected node with
<a href="/en/developer-reference#sendrawtransaction" class="auto-link"><code>sendrawtransaction</code></a>. This will allow us to illustrate in the Offline
Signing subsection below how to spend a transaction which is not yet in
the <a href="/en/developer-guide#block-chain" title="A chain of blocks with each block linking to the block that preceded; the most-difficult-to-recreate chain is The Block Chain" class="auto-link">block chain</a> or memory pool.</p>

  <h4 id="offline-signing">Offline Signing</h4>

  <p>We will now spend the transaction created in the Complex Raw Transaction
subsection above without sending it to the local node first. This is the
same basic process used by <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> programs for offline
signing—which generally means signing a transaction without access
to the current <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> set.</p>

  <p>Offline signing is safe. However, in this example we will also be
spending an <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> which is not part of the <a href="/en/developer-guide#block-chain" title="A chain of blocks with each block linking to the block that preceded; the most-difficult-to-recreate chain is The Block Chain" class="auto-link">block chain</a> because the
transaction containing it has never been <a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner" class="auto-link">broadcast</a>. That can be unsafe:</p>

  <p><img src="/img/icon_warning.svg" alt="Warning icon" />
 <strong>Warning:</strong> Transactions which spend <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">outputs</a> from <a href="/en/developer-guide#term-unconfirmed-transactions" title="A transaction which has not yet been added to the block chain" class="auto-link">unconfirmed
transactions</a> are vulnerable to <a href="/en/developer-guide#transaction-malleability" title="The ability of an attacker to change the transaction identifier (txid) of unconfirmed transactions, making dependent transactions invalid" class="auto-link">transaction malleability</a>. Be sure to read
about <a href="/en/developer-guide#transaction-malleability" title="The ability of an attacker to change the transaction identifier (txid) of unconfirmed transactions, making dependent transactions invalid" class="auto-link">transaction malleability</a> and adopt good practices before spending
<a href="/en/developer-guide#term-unconfirmed-transactions" title="A transaction which has not yet been added to the block chain" class="auto-link">unconfirmed transactions</a> on <a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a>.</p>

  <div class="highlight"><pre><code class="bash">&gt; <span class="nv">OLD_SIGNED_RAW_TX</span><span class="o">=</span>0100000002f327e86da3e66bd20e1129b1fb36d07056<span class="se">\</span>
      f0b9a117199e759396526b8f3a20780000000049483045022100fce442<span class="se">\</span>
      ec52aa2792efc27fd3ad0eaf7fa69f097fdcefab017ea56d1799b10b21<span class="se">\</span>
      02207a6ae3eb61e11ffaba0453f173d1792f1b7bb8e7422ea945101d68<span class="se">\</span>
      535c4b474801fffffffff0ede03d75050f20801d50358829ae02c058e8<span class="se">\</span>
      677d2cc74df51f738285013c26000000006b483045022100b77f935ff3<span class="se">\</span>
      66a6f3c2fdeb83589c790265d43b3d2cf5e5f0047da56c36de75f40220<span class="se">\</span>
      707ceda75d8dcf2ccaebc506f7293c3dcb910554560763d7659fb202f8<span class="se">\</span>
      ec324b012102240d7d3c7aad57b68aa0178f4c56f997d1bfab2ded3c2f<span class="se">\</span>
      9427686017c603a6d6ffffffff02f028d6dc010000001976a914ffb035<span class="se">\</span>
      781c3c69e076d48b60c3d38592e7ce06a788ac00ca9a3b000000001976<span class="se">\</span>
      a914fa5139067622fd7e1e722a05c17c2bb7d5fd6df088ac00000000
</code></pre>
</div>

  <p>Put the previously signed (but not sent) transaction into a shell
variable.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest decoderawtransaction <span class="nv">$OLD_SIGNED_RAW_TX</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;682cad881df69cb9df8f0c996ce96ecad758357ded2da03bad\</span>
<span class="s2">              40cf18ffbb8e09&quot;</span><span class="p">,</span>
    <span class="nt">&quot;version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;locktime&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;vin&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;78203a8f6b529693759e1917a1b9f05670d036fbb1\</span>
<span class="s2">                      29110ed26be6a36de827f3&quot;</span><span class="p">,</span>
            <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;scriptSig&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;3045022100fce442ec52aa2792efc27fd3ad0ea\</span>
<span class="s2">                         f7fa69f097fdcefab017ea56d1799b10b210220\</span>
<span class="s2">                         7a6ae3eb61e11ffaba0453f173d1792f1b7bb8e\</span>
<span class="s2">                         7422ea945101d68535c4b474801&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;483045022100FCE442ec52aa2792efc27fd3ad0\</span>
<span class="s2">                         eaf7fa69f097fdcefab017ea56d1799b10b2102\</span>
<span class="s2">                         207a6ae3eb61e11ffaba0453f173d1792f1b7bb\</span>
<span class="s2">                         8e7422ea945101d68535c4b474801&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;sequence&quot;</span> <span class="p">:</span> <span class="mi">4294967295</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835\</span>
<span class="s2">                      501d80200f05753de0edf0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;scriptSig&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;3045022100b77f935ff366a6f3c2fdeb83589c7\</span>
<span class="s2">                         90265d43b3d2cf5e5f0047da56c36de75f40220\</span>
<span class="s2">                         707ceda75d8dcf2ccaebc506f7293c3dcb91055\</span>
<span class="s2">                         4560763d7659fb202f8ec324b01</span>
<span class="s2">                         02240d7d3c7aad57b68aa0178f4c56f997d1bfa\</span>
<span class="s2">                         b2ded3c2f9427686017c603a6d6&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;483045022100b77f935ff366a6f3c2fdeb83589\</span>
<span class="s2">                         c790265d43b3d2cf5e5f0047da56c36de75f402\</span>
<span class="s2">                         20707ceda75d8dcf2ccaebc506f7293c3dcb910\</span>
<span class="s2">                         554560763d7659fb202f8ec324b012102240d7d\</span>
<span class="s2">                         3c7aad57b68aa0178f4c56f997d1bfab2ded3c2\</span>
<span class="s2">                         f9427686017c603a6d6&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;sequence&quot;</span> <span class="p">:</span> <span class="mi">4294967295</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mf">79.99990000</span><span class="p">,</span>
            <span class="nt">&quot;n&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;OP_DUP OP_HASH160 ffb035781c3c69e076d48\</span>
<span class="s2">                         b60c3d38592e7ce06a7 OP_EQUALVERIFY OP_CHECKSIG&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a914ffb035781c3c69e076d48b60c3d38592e\</span>
<span class="s2">                         7ce06a788ac&quot;</span><span class="p">,</span>
                <span class="nt">&quot;reqSigs&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;pubkeyhash&quot;</span><span class="p">,</span>
                <span class="nt">&quot;addresses&quot;</span> <span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;n4puhBEeEWD2VvjdRC9kQuX2abKxSCMNqN&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mf">10.00000000</span><span class="p">,</span>
            <span class="nt">&quot;n&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;OP_DUP OP_HASH160 fa5139067622fd7e1e722\</span>
<span class="s2">                         a05c17c2bb7d5fd6df0 OP_EQUALVERIFY OP_CHECKSIG&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;76a914fa5139067622fd7e1e722a05c17c2bb7d\</span>
<span class="s2">                         5fd6df088ac&quot;</span><span class="p">,</span>
                <span class="nt">&quot;reqSigs&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;pubkeyhash&quot;</span><span class="p">,</span>
                <span class="nt">&quot;addresses&quot;</span> <span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;n4LWXU59yM5MzQev7Jx7VNeq1BqZ85ZbLj&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">UTXO_TXID</span><span class="o">=</span>682cad881df69cb9df8f0c996ce96ecad758357ded2da03bad40<span class="o">[</span>...<span class="o">]</span>
&gt; <span class="nv">UTXO_VOUT</span><span class="o">=</span>1
&gt; <span class="nv">UTXO_OUTPUT_SCRIPT</span><span class="o">=</span>76a914fa5139067622fd7e1e722a05c17c2bb7d5fd6<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>Decode the signed raw transaction so we can get its <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a>. Also, choose a
specific one of its <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXOs</a> to spend and save that <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO’s</a> <a href="/en/developer-guide#term-output-index" title="The sequentially-numbered index of outputs in a single transaction starting from 0" class="auto-link">output index</a> number
(vout) and hex <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> (scriptPubKey) into shell variables.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest getnewaddress
mfdCHEFL2tW9eEUpizk7XLZJcnFM4hrp78

&gt; <span class="nv">NEW_ADDRESS</span><span class="o">=</span>mfdCHEFL2tW9eEUpizk7XLZJcnFM4hrp78
</code></pre>
</div>

  <p>Get a new <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> to spend the <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> to.</p>

  <div class="highlight"><pre><code class="bash"><span class="c">## Outputs - inputs = transaction fee, so always double-check your math!</span>
&gt; bitcoin-cli -regtest createrawtransaction <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO_TXID</span><span class="s1">&#39;&quot;,</span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO_VOUT</span><span class="s1">&#39;</span>
<span class="s1">      }</span>
<span class="s1">    ]</span>
<span class="s1">    &#39;&#39;&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    {</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS</span><span class="s1">&#39;&quot;: 9.9999</span>
<span class="s1">    }&#39;&#39;&#39;</span>
0100000001098ebbff18cf40ad3ba02ded7d3558d7ca6ee96c990c8fdfb99cf6<span class="se">\</span>
1d88ad2c680100000000ffffffff01f0a29a3b000000001976a914012e2ba6a0<span class="se">\</span>
51c033b03d712ca2ea00a35eac1e7988ac00000000

&gt; <span class="nv">RAW_TX</span><span class="o">=</span>0100000001098ebbff18cf40ad3ba02ded7d3558d7ca6ee96c990c8<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>Create the raw transaction the same way we’ve done in the previous
subsections.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">    &gt; bitcoin-cli -regtest signrawtransaction <span class="nv">$RAW_TX</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json">    <span class="p">{</span>
        <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;0100000001098ebbff18cf40ad3ba02ded7d3558d7ca6ee\</span>
<span class="s2">                 96c990c8fdfb99cf61d88ad2c680100000000ffffffff01\</span>
<span class="s2">                 f0a29a3b000000001976a914012e2ba6a051c033b03d712\</span>
<span class="s2">                 ca2ea00a35eac1e7988ac00000000&quot;</span><span class="p">,</span>
        <span class="nt">&quot;complete&quot;</span> <span class="p">:</span> <span class="kc">false</span>
    <span class="p">}</span>
</code></pre>
</div>

  </div>

  <p>Attempt to sign the raw transaction without any special arguments, the
way we successfully signed the the raw transaction in the Simple Raw
Transaction subsection. If you’ve read the <a href="/en/developer-guide#transactions" title="A transaction spending satoshis">Transaction section</a> of
the guide, you may know why the call fails and leaves the raw
transaction hex unchanged.</p>

  <p><img src="/img/dev/en-signing-output-to-spend.svg" alt="Old Transaction Data Required To Be Signed" /></p>

  <p>As illustrated above, the data that gets signed includes the <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a> and
vout from the previous transaction.  That information is included in the
<a href="/en/developer-reference#createrawtransaction" class="auto-link"><code>createrawtransaction</code></a> raw transaction.  But the data that gets signed
also includes the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> from the previous transaction, even
though it doesn’t appear in either the unsigned or signed transaction.</p>

  <p>In the other raw transaction subsections above, the previous <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> was
part of the <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> set known to the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>, so the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> was able to use
the <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a> and <a href="/en/developer-guide#term-output-index" title="The sequentially-numbered index of outputs in a single transaction starting from 0" class="auto-link">output index</a> number to find the previous <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> and
insert it automatically.</p>

  <p>In this case, you’re spending an <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> which is unknown to the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>,
so it can’t automatically insert the previous <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a>.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest signrawtransaction <span class="nv">$RAW_TX</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO_TXID</span><span class="s1">&#39;&quot;, </span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO_VOUT</span><span class="s1">&#39;, </span>
<span class="s1">        &quot;scriptPubKey&quot;: &quot;&#39;</span><span class="nv">$UTXO_OUTPUT_SCRIPT</span><span class="s1">&#39;&quot;</span>
<span class="s1">      }</span>
<span class="s1">    ]&#39;&#39;&#39;</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;0100000001098ebbff18cf40ad3ba02ded7d3558d7ca6ee96c9\</span>
<span class="s2">             90c8fdfb99cf61d88ad2c68010000006b483045022100c3f92f\</span>
<span class="s2">             b74bfa687d76ebe75a654510bb291b8aab6f89ded4fe26777c2\</span>
<span class="s2">             eb233ad02207f779ce2a181cc4055cb0362aba7fd7a6f72d5db\</span>
<span class="s2">             b9bd863f4faaf47d8d6c4b500121028e4e62d25760709806131\</span>
<span class="s2">             b014e2572f7590e70be01f0ef16bfbd51ea5f389d4dffffffff\</span>
<span class="s2">             01f0a29a3b000000001976a914012e2ba6a051c033b03d712ca\</span>
<span class="s2">             2ea00a35eac1e7988ac00000000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;complete&quot;</span> <span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">SIGNED_RAW_TX</span><span class="o">=</span>0100000001098ebbff18cf40ad3ba02ded7d3558d7ca6ee9<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>Successfully sign the transaction by providing the previous <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a>
<a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> and other required <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">input</a> data. </p>

  <p>This specific operation is typically what offline signing <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallets</a> do.
The online <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> creates the raw transaction and gets the previous
<a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">scripts</a> for all the <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">inputs</a>. The user brings this information to
the offline <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>. After displaying the transaction details to the
user, the offline <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> signs the transaction as we did above. The
user takes the signed transaction back to the online <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>, which
<a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner" class="auto-link">broadcasts</a> it.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest sendrawtransaction <span class="nv">$SIGNED_RAW_TX</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="err">error:</span> <span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="mi">-22</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;TX rejected&quot;</span><span class="p">}</span>
</code></pre>
</div>

  </div>

  <p>Attempt to <a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner" class="auto-link">broadcast</a> the second transaction before we’ve <a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner" class="auto-link">broadcast</a> the
first transaction.  The node rejects this attempt because the second
transaction spends an <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> which is not a <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> the node knows about.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest sendrawtransaction <span class="nv">$OLD_SIGNED_RAW_TX</span>
682cad881df69cb9df8f0c996ce96ecad758357ded2da03bad40cf18ffbb8e09
&gt; bitcoin-cli -regtest sendrawtransaction <span class="nv">$SIGNED_RAW_TX</span>
67d53afa1a8167ca093d30be7fb9dcb8a64a5fdecacec9d93396330c47052c57
</code></pre>
</div>

  <p><a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner" class="auto-link">Broadcast</a> the first transaction, which succeeds, and then <a href="/en/developer-guide#transaction-broadcasting" title="Sending transactions or blocks to all other peers on the Bitcoin network (compare to privately transmitting to a single peer or partner" class="auto-link">broadcast</a> the
second transaction—which also now succeeds because the node now sees
the <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a>.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest getrawmempool
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">[</span>
    <span class="s2">&quot;67d53afa1a8167ca093d30be7fb9dcb8a64a5fdecacec9d93396330c47052c57&quot;</span><span class="p">,</span>
    <span class="s2">&quot;682cad881df69cb9df8f0c996ce96ecad758357ded2da03bad40cf18ffbb8e09&quot;</span>
<span class="p">]</span>
</code></pre>
</div>

  </div>

  <p>We have once again not generated an additional <a href="/en/developer-guide#term-block" title="A block of transactions protected by proof of work" class="auto-link">block</a>, so the transactions
above have not yet become part of the <a href="/en/developer-examples#regtest-mode" title="A local testing environment in which developers can control blocks" class="auto-link">regtest</a> <a href="/en/developer-guide#block-chain" title="A chain of blocks with each block linking to the block that preceded; the most-difficult-to-recreate chain is The Block Chain" class="auto-link">block chain</a>.  However, they
are part of the local node’s memory pool.</p>

  <div class="highlight"><pre><code class="bash">&gt; <span class="nb">unset </span>OLD_SIGNED_RAW_TX SIGNED_RAW_TX RAW_TX <span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>Remove old shell variables. </p>

  <h4 id="p2sh-multisig">P2SH Multisig</h4>

  <p>In this subsection, we will create a <a href="/en/developer-guide#term-p2sh-multisig" title="A multisig script embedded in the redeemScript of a pay-to-script-hash (P2SH) transaction" class="auto-link">P2SH multisig</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>, spend
<a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> to it, and then spend those <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> from it to another
<a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>.</p>

  <p>Creating a <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">multisig</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> is easy. <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">Multisig</a> <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">outputs</a> have two
parameters, the <em>minimum</em> number of <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signatures</a> required (<em>m</em>) and the
<em>number</em> of <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> to use to validate those <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signatures</a>. This is
called m-of-n, and in this case we’ll be using 2-of-3.</p>

  <div class="highlight"><pre><code class="bash">    &gt; bitcoin-cli -regtest getnewaddress
    mhAXF4Eq7iRyvbYk1mpDVBiGdLP3YbY6Dm
    &gt; bitcoin-cli -regtest getnewaddress
    moaCrnRfP5zzyhW8k65f6Rf2z5QpvJzSKe
    &gt; bitcoin-cli -regtest getnewaddress
    mk2QpYatsKicvFVuTAQLBryyccRXMUaGHP

    &gt; <span class="nv">NEW_ADDRESS1</span><span class="o">=</span>mhAXF4Eq7iRyvbYk1mpDVBiGdLP3YbY6Dm
    &gt; <span class="nv">NEW_ADDRESS2</span><span class="o">=</span>moaCrnRfP5zzyhW8k65f6Rf2z5QpvJzSKe
    &gt; <span class="nv">NEW_ADDRESS3</span><span class="o">=</span>mk2QpYatsKicvFVuTAQLBryyccRXMUaGHP
</code></pre>
</div>

  <p>Generate three new <a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a>. <a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> cannot be used with
the <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">multisig</a> <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> created below. (Hashing each <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public key</a> is
unnecessary anyway—all the <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> are protected by a hash when
the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> is hashed.) However, Bitcoin Core uses <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> as a
way to reference the underlying full (unhashed) <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> it knows
about, so we get the three new <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> above in order to use their
<a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a>.</p>

  <p><a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address">Recall from the Guide</a> that the hashed <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> used in <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a>
obfuscate the full <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public key</a>, so you cannot give an <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> to another
person or device as part of creating a typical <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">multisig</a> <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> or <a href="/en/developer-guide#term-p2sh-multisig" title="A multisig script embedded in the redeemScript of a pay-to-script-hash (P2SH) transaction" class="auto-link">P2SH multisig</a>
<a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a>. You must give them a full <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public key</a>.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest validateaddress <span class="nv">$NEW_ADDRESS3</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;isvalid&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;mk2QpYatsKicvFVuTAQLBryyccRXMUaGHP&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ismine&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;isscript&quot;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;pubkey&quot;</span> <span class="p">:</span> <span class="s2">&quot;029e03a901b85534ff1e92c43c74431f7ce72046060fcf7a\</span>
<span class="s2">                95c37e148f78c77255&quot;</span><span class="p">,</span>
    <span class="nt">&quot;iscompressed&quot;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;account&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">NEW_ADDRESS3_PUBLIC_KEY</span><span class="o">=</span>029e03a901b85534ff1e92c43c74431f7ce720<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>Use the <a href="/en/developer-reference#validateaddress" class="auto-link"><code>validateaddress</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> to display the full (unhashed) <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public key</a>
for one of the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a>.  This is the information which will 
actually be included in the <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">multisig</a> <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a>.  This is also the
information you would give another person or device as part of creating
a <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">multisig</a> <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> or <a href="/en/developer-guide#term-p2sh-multisig" title="A multisig script embedded in the redeemScript of a pay-to-script-hash (P2SH) transaction" class="auto-link">P2SH multisig</a> <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a>.</p>

  <p>We save the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> returned to a shell variable.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest createmultisig 2 <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS1</span><span class="s1">&#39;&quot;,</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS2</span><span class="s1">&#39;&quot;, </span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS3_PUBLIC_KEY</span><span class="s1">&#39;&quot;</span>
<span class="s1">    ]&#39;&#39;&#39;</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;2N7NaqSKYQUeM8VNgBy8D9xQQbiA8yiJayk&quot;</span><span class="p">,</span>
    <span class="nt">&quot;redeemScript&quot;</span> <span class="p">:</span> <span class="s2">&quot;522103310188e911026cf18c3ce274e0ebb5f95b00\</span>
<span class="s2">    7f230d8cb7d09879d96dbeab1aff210243930746e6ed6552e03359db521b\</span>
<span class="s2">    088134652905bd2d1541fa9124303a41e95621029e03a901b85534ff1e92\</span>
<span class="s2">    c43c74431f7ce72046060fcf7a95c37e148f78c7725553ae&quot;</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">P2SH_ADDRESS</span><span class="o">=</span>2N7NaqSKYQUeM8VNgBy8D9xQQbiA8yiJayk
&gt; <span class="nv">P2SH_REDEEM_SCRIPT</span><span class="o">=</span>522103310188e911026cf18c3ce274e0ebb5f95b007<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>Use the <a href="/en/developer-reference#createmultisig" class="auto-link"><code>createmultisig</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> with two arguments, the number (<em>n</em>) of
<a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signatures</a> required and a list of <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> or <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a>.  Because
<a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> can’t be used in the <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">multisig</a> <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> created by this
<a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a>, the only <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> which can be provided are those belonging to a
<a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public key</a> in the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>.  In this case, we provide two <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> and
one <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public key</a>—all of which will be converted to <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> in the
<a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a>.</p>

  <p>The <a href="/en/developer-guide#term-p2sh" title="A script which Pays To Script Hashes (P2SH), allowing convenient spending of satoshis to an address referencing a script" class="auto-link">P2SH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> is returned along with the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> which must be
provided when we spend <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> sent to the <a href="/en/developer-guide#term-p2sh" title="A script which Pays To Script Hashes (P2SH), allowing convenient spending of satoshis to an address referencing a script" class="auto-link">P2SH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>.</p>

  <p><img src="/img/icon_warning.svg" alt="Warning icon" />
 <strong>Warning:</strong> You must not lose the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a>, especially if you
don’t have a record of which <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> you used to create the <a href="/en/developer-guide#term-p2sh-multisig" title="A multisig script embedded in the redeemScript of a pay-to-script-hash (P2SH) transaction" class="auto-link">P2SH
multisig</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>. You need the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> to spend any <a href="/en/developer-guide#term-bitcoins" title="A primary accounting unit used in Bitcoin; 100 million satoshis" class="auto-link">bitcoins</a> sent
to the <a href="/en/developer-guide#term-p2sh" title="A script which Pays To Script Hashes (P2SH), allowing convenient spending of satoshis to an address referencing a script" class="auto-link">P2SH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>. If you lose the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a>, you can recreate it
by running the same command above, with the <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> listed in the
same order. However, if you lose both the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> and even one of
the <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a>, you will never be able to spend <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> sent to that
<a href="/en/developer-guide#term-p2sh" title="A script which Pays To Script Hashes (P2SH), allowing convenient spending of satoshis to an address referencing a script" class="auto-link">P2SH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>.</p>

  <p>Neither the <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> nor the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> are stored in the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> when
you use <a href="/en/developer-reference#createmultisig" class="auto-link"><code>createmultisig</code></a>. To store them in the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>, use the
<a href="/en/developer-reference#addmultisigaddress" class="auto-link"><code>addmultisigaddress</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> instead.  If you add an <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> to the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>,
you should also make a new backup.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest sendtoaddress <span class="nv">$P2SH_ADDRESS</span> 10.00
7278d7d030f042ebe633732b512bcb31fff14a697675a1fe1884db139876e175

&gt; <span class="nv">UTXO_TXID</span><span class="o">=</span>7278d7d030f042ebe633732b512bcb31fff14a697675a1fe1884<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>Paying the <a href="/en/developer-guide#term-p2sh-multisig" title="A multisig script embedded in the redeemScript of a pay-to-script-hash (P2SH) transaction" class="auto-link">P2SH multisig</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> with Bitcoin Core is as simple as
paying a more common <a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a>. Here we use the same command (but
different variable) we used in the Simple Spending subsection. As
before, this command automatically selects an <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a>, creates a <a href="/en/developer-guide#term-change-output" title="An output used by a spender to send back to himself some of the satoshis from the inputs" class="auto-link">change
output</a> to a new one of our <a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">addresses</a> if necessary, and pays a
<a href="/en/developer-guide#term-transaction-fee" title="The amount remaining when all outputs are subtracted from all inputs in a transaction; the fee is paid to the miner who includes that transaction in a block" class="auto-link">transaction fee</a> if necessary.</p>

  <p>We save that <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a> to a shell variable as the <a href="/en/developer-guide#term-txid" title="A hash of a completed transaction which allows other transactions to spend its outputs" class="auto-link">txid</a> of the <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> we plan to spend next.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest getrawtransaction <span class="nv">$UTXO_TXID</span> 1
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;0100000001f0ede03d75050f20801d50358829ae02c058e8677\</span>
<span class="s2">             d2cc74df51f738285013c26010000006a47304402203c375959\</span>
<span class="s2">             2bf608ab79c01596c4a417f3110dd6eb776270337e575cdafc6\</span>
<span class="s2">             99af20220317ef140d596cc255a4067df8125db7f349ad94521\</span>
<span class="s2">             2e9264a87fa8d777151937012102a92913b70f9fb15a7ea5c42\</span>
<span class="s2">             df44637f0de26e2dad97d6d54957690b94cf2cd05ffffffff01\</span>
<span class="s2">             00ca9a3b0000000017a9149af61346ce0aa2dffcf697352b4b7\</span>
<span class="s2">             04c84dcbaff8700000000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;7278d7d030f042ebe633732b512bcb31fff14a697675a1fe18\</span>
<span class="s2">              84db139876e175&quot;</span><span class="p">,</span>
    <span class="nt">&quot;version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;locktime&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;vin&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;txid&quot;</span> <span class="p">:</span> <span class="s2">&quot;263c018582731ff54dc72c7d67e858c002ae298835\</span>
<span class="s2">                      501d80200f05753de0edf0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&quot;scriptSig&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;304402203c3759592bf608ab79c01596c4a417f\</span>
<span class="s2">                         3110dd6eb776270337e575cdafc699af2022031\</span>
<span class="s2">                         7ef140d596cc255a4067df8125db7f349ad9452\</span>
<span class="s2">                         12e9264a87fa8d77715193701</span>
<span class="s2">                         02a92913b70f9fb15a7ea5c42df44637f0de26e\</span>
<span class="s2">                         2dad97d6d54957690b94cf2cd05&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;47304402203c3759592bf608ab79c01596c4a41\</span>
<span class="s2">                         7f3110dd6eb776270337e575cdafc699af20220\</span>
<span class="s2">                         317ef140d596cc255a4067df8125db7f349ad94\</span>
<span class="s2">                         5212e9264a87fa8d777151937012102a92913b7\</span>
<span class="s2">                         0f9fb15a7ea5c42df44637f0de26e2dad97d6d5\</span>
<span class="s2">                         4957690b94cf2cd05&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;sequence&quot;</span> <span class="p">:</span> <span class="mi">4294967295</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;vout&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mf">10.00000000</span><span class="p">,</span>
            <span class="nt">&quot;n&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;scriptPubKey&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;asm&quot;</span> <span class="p">:</span> <span class="s2">&quot;OP_HASH160 9af61346ce0aa2dffcf697352b4b\</span>
<span class="s2">                704c84dcbaff OP_EQUAL&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;a9149af61346ce0aa2dffcf697352b4b704c84d\</span>
<span class="s2">                         cbaff87&quot;</span><span class="p">,</span>
                <span class="nt">&quot;reqSigs&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;scripthash&quot;</span><span class="p">,</span>
                <span class="nt">&quot;addresses&quot;</span> <span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;2N7NaqSKYQUeM8VNgBy8D9xQQbiA8yiJayk&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">UTXO_VOUT</span><span class="o">=</span>0
&gt; <span class="nv">UTXO_OUTPUT_SCRIPT</span><span class="o">=</span>a9149af61346ce0aa2dffcf697352b4b704c84dcbaff87
</code></pre>
</div>

  </div>

  <p>We use the <a href="/en/developer-reference#getrawtransaction" class="auto-link"><code>getrawtransaction</code></a> <a href="/en/developer-reference#remote-procedure-calls-rpcs" class="auto-link">RPC</a> with the optional second argument
(<em>true</em>) to get the decoded transaction we just created with
<code>spendtoaddress</code>. We choose one of the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">outputs</a> to be our <a href="/en/developer-guide#term-utxo" title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" class="auto-link">UTXO</a> and get
its <a href="/en/developer-guide#term-output-index" title="The sequentially-numbered index of outputs in a single transaction starting from 0" class="auto-link">output index</a> number (vout) and <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> (scriptPubKey).</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest getnewaddress
mxCNLtKxzgjg8yyNHeuFSXvxCvagkWdfGU

&gt; <span class="nv">NEW_ADDRESS4</span><span class="o">=</span>mxCNLtKxzgjg8yyNHeuFSXvxCvagkWdfGU
</code></pre>
</div>

  <p>We generate a new <a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> to use in the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> we’re about to
create.</p>

  <div class="highlight"><pre><code class="bash"><span class="c">## Outputs - inputs = transaction fee, so always double-check your math!</span>
&gt; bitcoin-cli -regtest createrawtransaction <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO_TXID</span><span class="s1">&#39;&quot;,</span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO_VOUT</span><span class="s1">&#39;</span>
<span class="s1">      }</span>
<span class="s1">   ]</span>
<span class="s1">   &#39;&#39;&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">   {</span>
<span class="s1">     &quot;&#39;</span><span class="nv">$NEW_ADDRESS4</span><span class="s1">&#39;&quot;: 9.998</span>
<span class="s1">   }&#39;&#39;&#39;</span>

010000000175e1769813db8418fea17576694af1ff31cb2b512b7333e6eb42f0<span class="se">\</span>
30d0d778720000000000ffffffff01c0bc973b000000001976a914b6f64f5bf3<span class="se">\</span>
e38f25ead28817df7929c06fe847ee88ac00000000

&gt; <span class="nv">RAW_TX</span><span class="o">=</span>010000000175e1769813db8418fea17576694af1ff31cb2b512b733<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>We generate the raw transaction the same way we did in the Simple Raw
Transaction subsection.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest dumpprivkey <span class="nv">$NEW_ADDRESS1</span>
cVinshabsALz5Wg4tGDiBuqEGq4i6WCKWXRQdM8RFxLbALvNSHw7
&gt; bitcoin-cli -regtest dumpprivkey <span class="nv">$NEW_ADDRESS3</span>
cNmbnwwGzEghMMe1vBwH34DFHShEj5bcXD1QpFRPHgG9Mj1xc5hq

&gt; <span class="nv">NEW_ADDRESS1_PRIVATE_KEY</span><span class="o">=</span>cVinshabsALz5Wg4tGDiBuqEGq4i6WCKWXRQd<span class="o">[</span>...<span class="o">]</span>
&gt; <span class="nv">NEW_ADDRESS3_PRIVATE_KEY</span><span class="o">=</span>cNmbnwwGzEghMMe1vBwH34DFHShEj5bcXD1Qp<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  <p>We get the <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> for two of the <a href="/en/developer-guide#term-public-key" title="The public portion of a keypair which can be safely distributed to other people so they can verify a signature created with the corresponding private key" class="auto-link">public keys</a> we used to create the
transaction, the same way we got <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> in the Complex Raw
Transaction subsection. Recall that we created a 2-of-3 <a href="/en/developer-guide#term-multisig" title="An output script using OP_CHECKMULTISIG to check for multiple signatures" class="auto-link">multisig</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a>,
so <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signatures</a> from two <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> are needed.</p>

  <p><img src="/img/icon_warning.svg" alt="Warning icon" />
 <strong>Reminder:</strong> Users should never manually manage <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private keys</a> on
<a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a>. See the warning in the <a href="/en/developer-examples#complex-raw-transaction">complex raw transaction section</a>.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest signrawtransaction <span class="nv">$RAW_TX</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO_TXID</span><span class="s1">&#39;&quot;, </span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO_VOUT</span><span class="s1">&#39;, </span>
<span class="s1">        &quot;scriptPubKey&quot;: &quot;&#39;</span><span class="nv">$UTXO_OUTPUT_SCRIPT</span><span class="s1">&#39;&quot;, </span>
<span class="s1">        &quot;redeemScript&quot;: &quot;&#39;</span><span class="nv">$P2SH_REDEEM_SCRIPT</span><span class="s1">&#39;&quot;</span>
<span class="s1">      }</span>
<span class="s1">    ]</span>
<span class="s1">    &#39;&#39;&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS1_PRIVATE_KEY</span><span class="s1">&#39;&quot;</span>
<span class="s1">    ]&#39;&#39;&#39;</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;010000000175e1769813db8418fea17576694af1ff31cb2b512\</span>
<span class="s2">             b7333e6eb42f030d0d7787200000000b5004830450221008d5e\</span>
<span class="s2">             c57d362ff6ef6602e4e756ef1bdeee12bd5c5c72697ef1455b3\</span>
<span class="s2">             79c90531002202ef3ea04dfbeda043395e5bc701e4878c15baa\</span>
<span class="s2">             b9c6ba5808eb3d04c91f641a0c014c69522103310188e911026\</span>
<span class="s2">             cf18c3ce274e0ebb5f95b007f230d8cb7d09879d96dbeab1aff\</span>
<span class="s2">             210243930746e6ed6552e03359db521b088134652905bd2d154\</span>
<span class="s2">             1fa9124303a41e95621029e03a901b85534ff1e92c43c74431f\</span>
<span class="s2">             7ce72046060fcf7a95c37e148f78c7725553aeffffffff01c0b\</span>
<span class="s2">             c973b000000001976a914b6f64f5bf3e38f25ead28817df7929\</span>
<span class="s2">             c06fe847ee88ac00000000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;complete&quot;</span> <span class="p">:</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">PARTLY_SIGNED_RAW_TX</span><span class="o">=</span>010000000175e1769813db8418fea17576694af1f<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>We make the first <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signature</a>. The <a href="/en/developer-guide#term-input" title="The input to a transaction linking to the output of a previous transaction which permits spending of satoshis" class="auto-link">input</a> argument (JSON object) takes the
additional <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a> parameter so that it can append the <a href="/en/developer-guide#term-redeemscript" title="A script created by the recipient, hashed, and given to the spender for use in a P2SH output" class="auto-link">redeemScript</a>
to the <a href="/en/developer-guide#term-scriptsig" title="Data generated by a spender which is almost always used as variables to satisfy an output script" class="auto-link">scriptSig</a> after the two <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signatures</a>.</p>

  <div class="multicode">

    <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest signrawtransaction <span class="nv">$PARTLY_SIGNED_RAW_TX</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;txid&quot;: &quot;&#39;</span><span class="nv">$UTXO_TXID</span><span class="s1">&#39;&quot;,</span>
<span class="s1">        &quot;vout&quot;: &#39;</span><span class="nv">$UTXO_VOUT</span><span class="s1">&#39;,</span>
<span class="s1">        &quot;scriptPubKey&quot;: &quot;&#39;</span><span class="nv">$UTXO_OUTPUT_SCRIPT</span><span class="s1">&#39;&quot;, </span>
<span class="s1">        &quot;redeemScript&quot;: &quot;&#39;</span><span class="nv">$P2SH_REDEEM_SCRIPT</span><span class="s1">&#39;&quot;</span>
<span class="s1">      }</span>
<span class="s1">    ]</span>
<span class="s1">    &#39;&#39;&#39;</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    [</span>
<span class="s1">      &quot;&#39;</span><span class="nv">$NEW_ADDRESS3_PRIVATE_KEY</span><span class="s1">&#39;&quot;</span>
<span class="s1">    ]&#39;&#39;&#39;</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">&quot;hex&quot;</span> <span class="p">:</span> <span class="s2">&quot;010000000175e1769813db8418fea17576694af1ff31cb2b512\</span>
<span class="s2">             b7333e6eb42f030d0d7787200000000fdfd0000483045022100\</span>
<span class="s2">             8d5ec57d362ff6ef6602e4e756ef1bdeee12bd5c5c72697ef14\</span>
<span class="s2">             55b379c90531002202ef3ea04dfbeda043395e5bc701e4878c1\</span>
<span class="s2">             5baab9c6ba5808eb3d04c91f641a0c0147304402200bd8c62b9\</span>
<span class="s2">             38e02094021e481b149fd5e366a212cb823187149799a68cfa7\</span>
<span class="s2">             652002203b52120c5cf25ceab5f0a6b5cdb8eca0fd2f386316c\</span>
<span class="s2">             9721177b75ddca82a4ae8014c69522103310188e911026cf18c\</span>
<span class="s2">             3ce274e0ebb5f95b007f230d8cb7d09879d96dbeab1aff21024\</span>
<span class="s2">             3930746e6ed6552e03359db521b088134652905bd2d1541fa91\</span>
<span class="s2">             24303a41e95621029e03a901b85534ff1e92c43c74431f7ce72\</span>
<span class="s2">             046060fcf7a95c37e148f78c7725553aeffffffff01c0bc973b\</span>
<span class="s2">             000000001976a914b6f64f5bf3e38f25ead28817df7929c06fe\</span>
<span class="s2">             847ee88ac00000000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;complete&quot;</span> <span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>
</div>

    <div class="highlight"><pre><code class="bash"> 
&gt; <span class="nv">SIGNED_RAW_TX</span><span class="o">=</span>010000000175e1769813db8418fea17576694af1ff31cb2b<span class="o">[</span>...<span class="o">]</span>
</code></pre>
</div>

  </div>

  <p>The <a href="/en/developer-reference#signrawtransaction" class="auto-link"><code>signrawtransaction</code></a> call used here is nearly identical to the one
used above.  The only difference is the <a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private key</a> used.  Now that the
two required <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signatures</a> have been provided, the transaction is marked as
complete.</p>

  <div class="highlight"><pre><code class="bash">&gt; bitcoin-cli -regtest sendrawtransaction <span class="nv">$SIGNED_RAW_TX</span>
430a4cee3a55efb04cbb8718713cab18dea7f2521039aa660ffb5aae14ff3f50
</code></pre>
</div>

  <p>We send the transaction spending the <a href="/en/developer-guide#term-p2sh-multisig" title="A multisig script embedded in the redeemScript of a pay-to-script-hash (P2SH) transaction" class="auto-link">P2SH multisig</a> <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> to the local
node, which accepts it.</p>

  <h2 id="payment-processing">Payment Processing</h2>

  <h3 id="payment-protocol">Payment Protocol</h3>

  <p>To request payment using the <a href="/en/developer-guide#term-payment-protocol" title="The protocol defined in BIP70 which lets spenders get signed payment details from receivers" class="auto-link">payment protocol</a>, you use an extended (but
backwards-compatible) <a href="/en/developer-guide#term-bitcoin-uri" title="A URI which allows receivers to encode payment details so spenders don't have to manually enter addresses and other details" class="auto-link"><code>bitcoin:</code> URI</a>.  For example:</p>

  <pre><code>bitcoin:mjSk1Ny9spzU2fouzYgLqGUD8U41iR35QN\
?amount=0.10\
&amp;label=Example+Merchant\
&amp;message=Order+of+flowers+%26+chocolates\
&amp;r=https://example.com/pay.php/invoice%3Dda39a3ee
</code></pre>

  <p>The browser, QR code reader, or other program processing the URI opens
the spender’s Bitcoin <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program on the URI. If the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program is
aware of the <a href="/en/developer-guide#term-payment-protocol" title="The protocol defined in BIP70 which lets spenders get signed payment details from receivers" class="auto-link">payment protocol</a>, it accesses the URL specified in the <a href="/en/developer-guide#term-r-parameter" title="The payment request parameter in a bitcoin: URI" class="auto-link"><code>r</code></a>
parameter, which should provide it with a serialized <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>
served with the <a href="https://en.wikipedia.org/wiki/Internet_media_type">MIME</a> type <code>application/bitcoin-paymentrequest</code>.</p>

  <p><strong>Resource:</strong> Gavin Andresen’s <a href="http://bitcoincore.org/~gavin/createpaymentrequest.php">Payment Request Generator</a> generates
custom example URIs and payment requests for use with <a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">testnet</a>.</p>

  <h4 id="paymentrequest--paymentdetails">PaymentRequest &amp; PaymentDetails</h4>

  <p>The <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" id="term-paymentrequest" class="term">PaymentRequest</a> is created with data structures built using
Google’s <a href="https://developers.google.com/protocol-buffers/" class="auto-link">Protocol Buffers</a>. <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" class="auto-link">BIP70</a> describes these data
structures in the non-sequential way they’re defined in the payment
request <a href="https://developers.google.com/protocol-buffers/" class="auto-link">protocol buffer</a> code, but the text below will describe them in
a more linear order using a simple (but functional) Python CGI
program. (For brevity and clarity, many normal CGI best practices are
not used in this program.)</p>

  <p>The full sequence of events is illustrated below, starting with the
spender clicking a <a href="/en/developer-guide#term-bitcoin-uri" title="A URI which allows receivers to encode payment details so spenders don't have to manually enter addresses and other details" class="auto-link"><code>bitcoin:</code> URI</a> or scanning a <code>bitcoin:</code> QR code.</p>

  <p><img src="/img/dev/en-payment-protocol.svg" alt="BIP70 Payment Protocol" /></p>

  <p>For the <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> to use the <a href="https://developers.google.com/protocol-buffers/" class="auto-link">protocol buffer</a>, you will need a copy of
Google’s <a href="https://developers.google.com/protocol-buffers/" class="auto-link">Protocol Buffer</a> compiler (<code>protoc</code>), which is available in most
modern Linux package managers and <a href="https://developers.google.com/protocol-buffers/">directly from Google.</a> Non-Google
<a href="https://developers.google.com/protocol-buffers/" class="auto-link">protocol buffer</a> compilers are available for a variety of
programming languages. You will also need a copy of the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>
<a href="https://github.com/bitcoin/bitcoin/blob/master/src/qt/paymentrequest.proto">Protocol Buffer description</a> from the Bitcoin Core source code.</p>

  <h5 id="initialization-code">Initialization Code</h5>

  <p>With the Python code generated by <code>protoc</code>, we can start our simple
CGI program.</p>

  <div class="highlight"><pre><code class="python"><span class="c">#!/usr/bin/env python</span>

<span class="c">## This is the code generated by protoc --python_out=./ paymentrequest.proto</span>
<span class="kn">from</span> <span class="nn">paymentrequest_pb2</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c">## Load some functions</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">stdout</span>
<span class="kn">from</span> <span class="nn">OpenSSL.crypto</span> <span class="kn">import</span> <span class="n">FILETYPE_PEM</span><span class="p">,</span> <span class="n">load_privatekey</span><span class="p">,</span> <span class="n">sign</span>

<span class="c">## Copy three of the classes created by protoc into objects we can use</span>
<span class="n">details</span> <span class="o">=</span> <span class="n">PaymentDetails</span><span class="p">()</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">PaymentRequest</span><span class="p">()</span>
<span class="n">x509</span> <span class="o">=</span> <span class="n">X509Certificates</span><span class="p">()</span>
</code></pre>
</div>

  <p>The startup code above is quite simple, requiring nothing but the epoch
(Unix date) time function, the standard out file descriptor, a few
functions from the OpenSSL library, and the data structures and
functions created by <code>protoc</code>.</p>

  <h5 id="configuration-code">Configuration Code</h5>

  <p>Next, we’ll set configuration settings which will typically only change
when the receiver wants to do something differently. The code pushes a
few settings into the <code>request</code> (<a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>) and <code>details</code>
(<a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" class="auto-link">PaymentDetails</a>) objects. When we serialize them,
<a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" id="term-paymentdetails" class="term">PaymentDetails</a> will be contained
within the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>.</p>

  <div class="highlight"><pre><code class="python"><span class="c">## SSL Signature method</span>
<span class="n">request</span><span class="o">.</span><span class="n">pki_type</span> <span class="o">=</span> <span class="s">&quot;x509+sha256&quot;</span>  <span class="c">## Default: none</span>

<span class="c">## Mainnet or Testnet?</span>
<span class="n">details</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="s">&quot;test&quot;</span>  <span class="c">## Default: main</span>

<span class="c">## Postback URL</span>
<span class="n">details</span><span class="o">.</span><span class="n">payment_url</span> <span class="o">=</span> <span class="s">&quot;https://example.com/pay.py&quot;</span>

<span class="c">## PaymentDetails version number</span>
<span class="n">request</span><span class="o">.</span><span class="n">payment_details_version</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">## Default: 1</span>

<span class="c">## Certificate chain</span>
<span class="n">x509</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">file</span><span class="p">(</span><span class="s">&quot;/etc/apache2/example.com-cert.der&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="c">#x509.certificate.append(file(&quot;/some/intermediate/cert.der&quot;, &quot;r&quot;).read())</span>

<span class="c">## Load private SSL key into memory for signing later</span>
<span class="n">priv_key</span> <span class="o">=</span> <span class="s">&quot;/etc/apache2/example.com-key.pem&quot;</span>
<span class="n">pw</span> <span class="o">=</span> <span class="s">&quot;test&quot;</span>  <span class="c">## Key password</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">load_privatekey</span><span class="p">(</span><span class="n">FILETYPE_PEM</span><span class="p">,</span> <span class="nb">file</span><span class="p">(</span><span class="n">priv_key</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">pw</span><span class="p">)</span>
</code></pre>
</div>

  <p>Each line is described below.</p>

  <div class="highlight"><pre><code class="python"><span class="n">request</span><span class="o">.</span><span class="n">pki_type</span> <span class="o">=</span> <span class="s">&quot;x509+sha256&quot;</span>  <span class="c">## Default: none</span>
</code></pre>
</div>

  <p><a href="/en/developer-examples#term-pp-pki-type" title="The PKI field of a PaymentRequest which tells spenders how to validate this request as being from a specific recipient" class="auto-link"><code>pki_type</code></a>: (optional) tell the receiving <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program what <a href="/en/developer-examples#term-pki" title="Public Key Infrastructure; usually meant to indicate the X.509 certificate system used for HTTP Secure (https)." id="term-pki" class="term">Public-Key
Infrastructure</a> (<a href="/en/developer-examples#term-pki" title="Public Key Infrastructure; usually meant to indicate the X.509 certificate system used for HTTP Secure (https)." class="auto-link">PKI</a>) type you’re using to
cryptographically sign your <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a> so that it can’t be modified
by a man-in-the-middle attack. </p>

  <p>If you don’t want to sign the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>, you can choose a
<a href="/en/developer-examples#term-pp-pki-type" title="The PKI field of a PaymentRequest which tells spenders how to validate this request as being from a specific recipient" id="term-pp-pki-type" class="term"><code>pki_type</code></a> of <code>none</code>
(the default).</p>

  <p>If you do choose the sign the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>, you currently have two
options defined by <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" class="auto-link">BIP70</a>: <code>x509+sha1</code> and <code>x509+sha256</code>.  Both options
use the <a href="https://en.wikipedia.org/wiki/X.509" class="auto-link">X.509</a> certificate system, the same system used for HTTP Secure
(HTTPS).  To use either option, you will need a certificate signed by a
certificate authority or one of their intermediaries. (A self-signed
certificate will not work.)</p>

  <p>Each <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program may choose which certificate authorities to trust,
but it’s likely that they’ll trust whatever certificate authorities their
operating system trusts.  If the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program doesn’t have a full
operating system, as might be the case for small hardware <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallets</a>, <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" class="auto-link">BIP70</a>
suggests they use the <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/">Mozilla Root Certificate Store</a>. In
general, if a certificate works in your web browser when you connect to
your webserver, it will work for your <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequests</a>.</p>

  <div class="highlight"><pre><code class="python"><span class="n">details</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="s">&quot;test&quot;</span>  <span class="c">## Default: main</span>
</code></pre>
</div>

  <p><code>network</code>: (optional) tell the spender’s <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program what Bitcoin <a href="/en/developer-guide#term-network" title="The Bitcoin P2P network which broadcasts transactions and blocks" class="auto-link">network</a> you’re
using; <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" class="auto-link">BIP70</a> defines “main” for <a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a> (actual payments) and “test” for
<a href="/en/developer-examples#testnet" title="A Bitcoin-like network where the satoshis have no real-world value to allow risk-free testing" class="auto-link">testnet</a> (like <a href="/en/developer-examples#term-mainnet" title="The Bitcoin main network used to transfer satoshis (compare to testnet, the test network)" class="auto-link">mainnet</a>, but fake <a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> are used). If the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>
program doesn’t run on the <a href="/en/developer-guide#term-network" title="The Bitcoin P2P network which broadcasts transactions and blocks" class="auto-link">network</a> you indicate, it will reject the
<a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>.</p>

  <div class="highlight"><pre><code class="python"><span class="n">details</span><span class="o">.</span><span class="n">payment_url</span> <span class="o">=</span> <span class="s">&quot;https://example.com/pay.py&quot;</span>
</code></pre>
</div>

  <p><code>payment_url</code>: (required) tell the spender’s <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program where to send the Payment
message (described later). This can be a static URL, as in this example,
or a variable URL such as <code>https://example.com/pay.py?invoice=123.</code>
It should usually be an HTTPS <a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> to prevent man-in-the-middle
attacks from modifying the message.</p>

  <div class="highlight"><pre><code class="python"><span class="n">request</span><span class="o">.</span><span class="n">payment_details_version</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">## Default: 1</span>
</code></pre>
</div>

  <p><code>payment_details_version</code>: (optional) tell the spender’s <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a> program what version of the
<a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" class="auto-link">PaymentDetails</a> you’re using. As of this writing, the only version is
version 1.</p>

  <div class="highlight"><pre><code class="python"><span class="c">## This is the pubkey/certificate corresponding to the private SSL key</span>
<span class="c">## that we&#39;ll use to sign:</span>
<span class="n">x509</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">file</span><span class="p">(</span><span class="s">&quot;/etc/apache2/example.com-cert.der&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre>
</div>

  <p><code>x509certificates</code>: (required for signed <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequests</a>) you must
provide the public SSL key/certificate corresponding to the private SSL
key you’ll use to sign the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>. The certificate must be in
ASN.1/<a href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One" class="auto-link">DER format</a>.</p>

  <div class="highlight"><pre><code class="python"><span class="c">## If the pubkey/cert above didn&#39;t have the signature of a root</span>
<span class="c">## certificate authority, we&#39;d then append the intermediate certificate</span>
<span class="c">## which signed it:</span>
<span class="c">#x509.certificate.append(file(&quot;/some/intermediate/cert.der&quot;, &quot;r&quot;).read())</span>
</code></pre>
</div>

  <p>You must also provide any <a href="/en/developer-examples#term-intermediate-certificate" title="A intermediate certificate authority certificate which helps connect a leaf (receiver) certificate to a root certificate authority" class="auto-link">intermediate certificates</a> necessary to link
your certificate to the <a href="/en/developer-examples#term-root-certificate" title="A certificate belonging to a certificate authority (CA)" class="auto-link">root certificate</a> of a certificate authority
trusted by the spender’s software, such as a certificate from the
Mozilla root store.</p>

  <p>The certificates must be provided in a specific order—the same order
used by Apache’s <code>SSLCertificateFile</code> directive and other server
software.   The figure below shows the <a href="/en/developer-examples#term-certificate-chain" title="A chain of certificates connecting a individual's leaf certificate to the certificate authority's root certificate" id="term-certificate-chain" class="term">certificate chain</a> of the
www.bitcoin.org <a href="https://en.wikipedia.org/wiki/X.509" class="auto-link">X.509</a> certificate and how each certificate (except the
<a href="/en/developer-examples#term-root-certificate" title="A certificate belonging to a certificate authority (CA)" class="auto-link">root certificate</a>) would be loaded into the <a href="/en/developer-examples#term-x509certificates" id="term-x509certificates" class="term">X509Certificates</a> <a href="https://developers.google.com/protocol-buffers/" class="auto-link">protocol
buffer</a> message.</p>

  <p><img src="/img/dev/en-cert-order.svg" alt="X509Certificates Loading Order" /></p>

  <p>To be specific, the first certificate provided must be the
<a href="https://en.wikipedia.org/wiki/X.509" class="auto-link">X.509</a> certificate corresponding to the private SSL key which will make the
signature, called the <a href="/en/developer-examples#term-leaf-certificate" title="The end-node in a certificate chain; in the payment protocol, it is the certificate belonging to the receiver of satoshis" id="term-leaf-certificate" class="term">leaf certificate</a>. Any <a href="/en/developer-examples#term-intermediate-certificate" title="A intermediate certificate authority certificate which helps connect a leaf (receiver) certificate to a root certificate authority" id="term-intermediate-certificate" class="term">intermediate
certificates</a> necessary to link that signed public SSL
key to the <a href="/en/developer-examples#term-root-certificate" title="A certificate belonging to a certificate authority (CA)" id="term-root-certificate" class="term">root
certificate</a> (the certificate authority) are attached separately, with each
certificate in <a href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One" class="auto-link">DER format</a> bearing the signature of the certificate that
follows it all the way to (but not including) the <a href="/en/developer-examples#term-root-certificate" title="A certificate belonging to a certificate authority (CA)" class="auto-link">root certificate</a>.</p>

  <div class="highlight"><pre><code class="python"><span class="n">priv_key</span> <span class="o">=</span> <span class="s">&quot;/etc/apache2/example.com-key.pem&quot;</span>
<span class="n">pw</span> <span class="o">=</span> <span class="s">&quot;test&quot;</span>  <span class="c">## Key password</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="n">load_privatekey</span><span class="p">(</span><span class="n">FILETYPE_PEM</span><span class="p">,</span> <span class="nb">file</span><span class="p">(</span><span class="n">priv_key</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">pw</span><span class="p">)</span>
</code></pre>
</div>

  <p>(Required for signed <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequests</a>) you will need a private SSL key in
a format your SSL library supports (<a href="https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One" class="auto-link">DER format</a> is not required). In this
program, we’ll load it from a PEM file. (Embedding your passphrase in
your CGI code, as done here, is obviously a bad idea in real life.)</p>

  <p>The private SSL key will not be transmitted with your request. We’re
only loading it into memory here so we can use it to sign the request
later.</p>

  <h5 id="code-variables">Code Variables</h5>

  <p>Now let’s look at the variables your CGI program will likely set for
each payment.</p>

  <div class="highlight"><pre><code class="python"><span class="c">## Amount of the request</span>
<span class="n">amount</span> <span class="o">=</span> <span class="mi">10000000</span>  <span class="c">## In satoshis</span>

<span class="c">## P2PKH pubkey hash</span>
<span class="n">pubkey_hash</span> <span class="o">=</span> <span class="s">&quot;2b14950b8d31620c6cc923c5408a701b1ec0a020&quot;</span>
<span class="c">## P2PKH output script entered as hex and converted to binary</span>
<span class="c"># OP_DUP OP_HASH160 &lt;push 20 bytes&gt; &lt;pubKey hash&gt; OP_EQUALVERIFY OP_CHECKSIG</span>
<span class="c">#   76       a9            14       &lt;pubKey hash&gt;        88          ac</span>
<span class="n">hex_script</span> <span class="o">=</span> <span class="s">&quot;76&quot;</span> <span class="o">+</span> <span class="s">&quot;a9&quot;</span> <span class="o">+</span> <span class="s">&quot;14&quot;</span> <span class="o">+</span> <span class="n">pubkey_hash</span> <span class="o">+</span> <span class="s">&quot;88&quot;</span> <span class="o">+</span> <span class="s">&quot;ac&quot;</span>
<span class="n">serialized_script</span> <span class="o">=</span> <span class="n">hex_script</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;hex&quot;</span><span class="p">)</span>

<span class="c">## Load amount and script into PaymentDetails</span>
<span class="n">details</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">amount</span> <span class="o">=</span> <span class="n">amount</span><span class="p">,</span> <span class="n">script</span> <span class="o">=</span> <span class="n">serialized_script</span><span class="p">)</span>

<span class="c">## Memo to display to the spender</span>
<span class="n">details</span><span class="o">.</span><span class="n">memo</span> <span class="o">=</span> <span class="s">&quot;Flowers &amp; chocolates&quot;</span>

<span class="c">## Data which should be returned to you with the payment</span>
<span class="n">details</span><span class="o">.</span><span class="n">merchant_data</span> <span class="o">=</span> <span class="s">&quot;Invoice #123&quot;</span>
</code></pre>
</div>

  <p>Each line is described below.</p>

  <div class="highlight"><pre><code class="python"><span class="n">amount</span> <span class="o">=</span> <span class="mi">10000000</span>  <span class="c">## In satoshis (=100 mBTC)</span>
</code></pre>
</div>

  <p><a href="/en/developer-examples#term-pp-amount" title="Part of the Output part of the PaymentDetails part of a payment protocol where receivers can specify the amount of satoshis they want paid to a particular output script" class="auto-link"><code>amount</code></a>: (optional) the <a href="/en/developer-examples#term-pp-amount" title="Part of the Output part of the PaymentDetails part of a payment protocol where receivers can specify the amount of satoshis they want paid to a particular output script" id="term-pp-amount" class="term">amount</a> you want the spender to pay. You’ll probably get
  this value from your shopping cart application or <a href="/en/developer-guide#term-fiat" title="National currencies such as the dollar or euro" class="auto-link">fiat</a>-to-BTC exchange
  rate conversion tool. If you leave the amount blank, the <a href="/en/developer-guide#wallets" title="Software which stores private keys to allow users to spend and receive satoshis" class="auto-link">wallet</a>
  program will prompt the spender how much to pay (which can be useful
  for donations).</p>

  <div class="highlight"><pre><code class="python"><span class="n">pubkey_hash</span> <span class="o">=</span> <span class="s">&quot;2b14950b8d31620c6cc923c5408a701b1ec0a020&quot;</span>
<span class="c"># OP_DUP OP_HASH160 &lt;push 20 bytes&gt; &lt;pubKey hash&gt; OP_EQUALVERIFY OP_CHECKSIG</span>
<span class="c">#   76       a9            14       &lt;pubKey hash&gt;        88          ac</span>
<span class="n">hex_script</span> <span class="o">=</span> <span class="s">&quot;76&quot;</span> <span class="o">+</span> <span class="s">&quot;a9&quot;</span> <span class="o">+</span> <span class="s">&quot;14&quot;</span> <span class="o">+</span> <span class="n">pubkey_hash</span> <span class="o">+</span> <span class="s">&quot;88&quot;</span> <span class="o">+</span> <span class="s">&quot;ac&quot;</span>
<span class="n">serialized_script</span> <span class="o">=</span> <span class="n">hex_script</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;hex&quot;</span><span class="p">)</span>
</code></pre>
</div>

  <p><a href="/en/developer-examples#term-pp-script" title="The script field of a PaymentDetails where the receiver tells the spender what output scripts to pay" class="auto-link"><code>script</code></a>: (required) You must specify the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> you want the spender to
pay—any valid <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> is acceptable. In this example, we’ll request
payment to a <a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a>.  </p>

  <p>First we get a <a href="/en/developer-guide#term-pubkey-hash" title="The hash of a public key which can be included in a P2PKH output" class="auto-link">pubkey hash</a>. The hash above is the hash form of the
<a href="/en/developer-guide#term-address" title="A 20-byte hash formatted as a P2PKH or P2SH Bitcoin Address" class="auto-link">address</a> used in the URI examples throughout this section,
mjSk1Ny9spzU2fouzYgLqGUD8U41iR35QN.</p>

  <p>Next, we plug that hash into the standard <a href="/en/developer-guide#term-p2pkh" title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" class="auto-link">P2PKH</a> <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> using hex,
as illustrated by the code comments.</p>

  <p>Finally, we convert the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> from hex into its serialized form.</p>

  <div class="highlight"><pre><code class="python"><span class="n">details</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">amount</span> <span class="o">=</span> <span class="n">amount</span><span class="p">,</span> <span class="n">script</span> <span class="o">=</span> <span class="n">serialized_script</span><span class="p">)</span>
</code></pre>
</div>

  <p><code>outputs</code>: (required) add the <a href="/en/developer-guide#term-output" title="The output of a transaction which transfers value to a script" class="auto-link">output</a> <a href="/en/developer-guide#term-script" title="The part of an output which sets the conditions for spending of the satoshis in that output" class="auto-link">script</a> and (optional) amount to the
<a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" class="auto-link">PaymentDetails</a> outputs array. </p>

  <p>It’s possible to specify multiple <a href="/en/developer-examples#term-pp-script" title="The script field of a PaymentDetails where the receiver tells the spender what output scripts to pay" id="term-pp-script" class="term"><code>scripts</code></a> and <code>amounts</code> as part of a <a href="/en/developer-guide#term-merge-avoidance" title="A strategy for selecting which outputs to spend that avoids merging outputs with different histories that could leak private information" class="auto-link">merge
avoidance</a> strategy, described later in the <a href="/en/developer-guide#merge-avoidance">Merge Avoidance
subsection</a>. However, effective <a href="/en/developer-guide#term-merge-avoidance" title="A strategy for selecting which outputs to spend that avoids merging outputs with different histories that could leak private information" class="auto-link">merge avoidance</a> is not possible under
the base <a href="https://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki" class="auto-link">BIP70</a> rules in which the spender pays each <a href="/en/developer-examples#term-pp-script" title="The script field of a PaymentDetails where the receiver tells the spender what output scripts to pay" class="auto-link"><code>script</code></a> the exact
amount specified by its paired <a href="/en/developer-examples#term-pp-amount" title="Part of the Output part of the PaymentDetails part of a payment protocol where receivers can specify the amount of satoshis they want paid to a particular output script" class="auto-link"><code>amount</code></a>. If the amounts are omitted from
all <a href="/en/developer-examples#term-pp-amount" title="Part of the Output part of the PaymentDetails part of a payment protocol where receivers can specify the amount of satoshis they want paid to a particular output script" class="auto-link"><code>amount</code></a>/<a href="/en/developer-examples#term-pp-script" title="The script field of a PaymentDetails where the receiver tells the spender what output scripts to pay" class="auto-link"><code>script</code></a> pairs, the spender will be prompted to choose an
amount to pay.</p>

  <div class="highlight"><pre><code class="python"><span class="n">details</span><span class="o">.</span><span class="n">memo</span> <span class="o">=</span> <span class="s">&quot;Flowers &amp; chocolates&quot;</span>
</code></pre>
</div>

  <p><a href="/en/developer-examples#term-pp-memo" title="The memo fields of PaymentDetails, Payment, and PaymentACK which allow spenders and receivers to send each other memos" class="auto-link"><code>memo</code></a>: (optional) add a memo which will be displayed to the spender as
plain UTF-8 text. Embedded HTML or other markup will not be processed.</p>

  <div class="highlight"><pre><code class="python"><span class="n">details</span><span class="o">.</span><span class="n">merchant_data</span> <span class="o">=</span> <span class="s">&quot;Invoice #123&quot;</span>
</code></pre>
</div>

  <p><a href="/en/developer-examples#term-pp-merchant-data" title="The merchant_data part of PaymentDetails and Payment which allows the receiver to send arbitrary data to the spender in PaymentDetails and receive it back in Payments" class="auto-link"><code>merchant_data</code></a>: (optional) add arbitrary data which should be sent back to the
receiver when the invoice is paid. You can use this to track your
invoices, although you can more reliably track payments by generating a
<a href="/en/developer-guide#term-unique-address" title="Address which are only used once to protect privacy and increase security" class="auto-link">unique address</a> for each payment and then tracking when it gets paid. </p>

  <p>The <a href="/en/developer-examples#term-pp-memo" title="The memo fields of PaymentDetails, Payment, and PaymentACK which allow spenders and receivers to send each other memos" id="term-pp-memo" class="term"><code>memo</code></a> field and the <a href="/en/developer-examples#term-pp-merchant-data" title="The merchant_data part of PaymentDetails and Payment which allows the receiver to send arbitrary data to the spender in PaymentDetails and receive it back in Payments" id="term-pp-merchant-data" class="term"><code>merchant_data</code></a> field can be arbitrarily long,
but if you make them too long, you’ll run into the 50,000 byte limit on
the entire <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>, which includes the often several kilobytes
given over to storing the <a href="/en/developer-examples#term-certificate-chain" title="A chain of certificates connecting a individual's leaf certificate to the certificate authority's root certificate" class="auto-link">certificate chain</a>. As will be described in a
later subsection, the <a href="/en/developer-examples#term-pp-memo" title="The memo fields of PaymentDetails, Payment, and PaymentACK which allow spenders and receivers to send each other memos" class="auto-link"><code>memo</code></a> field can be used by the spender after
payment as part of a cryptographically-proven <a href="/en/developer-guide#term-receipt" title="A cryptographically-verifiable receipt created using parts of a payment request and a confirmed transaction" class="auto-link">receipt</a>.</p>

  <h5 id="derivable-data">Derivable Data</h5>

  <p>Next, let’s look at some information your CGI program can
automatically derive.</p>

  <div class="highlight"><pre><code class="python"><span class="c">## Request creation time</span>
<span class="n">details</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">())</span> <span class="c">## Current epoch (Unix) time</span>

<span class="c">## Request expiration time</span>
<span class="n">details</span><span class="o">.</span><span class="n">expires</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">())</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c">## 10 minutes from now</span>

<span class="c">## PaymentDetails is complete; serialize it and store it in PaymentRequest</span>
<span class="n">request</span><span class="o">.</span><span class="n">serialized_payment_details</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">()</span>

<span class="c">## Serialized certificate chain</span>
<span class="n">request</span><span class="o">.</span><span class="n">pki_data</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">()</span>

<span class="c">## Initialize signature field so we can sign the full PaymentRequest</span>
<span class="n">request</span><span class="o">.</span><span class="n">signature</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

<span class="c">## Sign PaymentRequest</span>
<span class="n">request</span><span class="o">.</span><span class="n">signature</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">(),</span> <span class="s">&quot;sha256&quot;</span><span class="p">)</span>
</code></pre>
</div>

  <p>Each line is described below.</p>

  <div class="highlight"><pre><code class="python"><span class="n">details</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">())</span> <span class="c">## Current epoch (Unix) time</span>
</code></pre>
</div>

  <p><code>time</code>: (required) <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequests</a> must indicate when they were created
in number of seconds elapsed since 1970-01-01T00:00 UTC (Unix
epoch time format).</p>

  <div class="highlight"><pre><code class="python"><span class="n">details</span><span class="o">.</span><span class="n">expires</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">())</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c">## 10 minutes from now</span>
</code></pre>
</div>

  <p><a href="/en/developer-examples#term-pp-expires" title="The expires field of a PaymentDetails where the receiver tells the spender when the PaymentDetails expires" class="auto-link"><code>expires</code></a>: (optional) the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a> may also set an <a href="/en/developer-examples#term-pp-expires" title="The expires field of a PaymentDetails where the receiver tells the spender when the PaymentDetails expires" id="term-pp-expires" class="term"><code>expires</code></a> time after
which they’re no longer valid. You probably want to give receivers
the ability to configure the expiration time delta; here we used the
reasonable choice of 10 minutes. If this request is tied to an order
total based on a <a href="/en/developer-guide#term-fiat" title="National currencies such as the dollar or euro" class="auto-link">fiat</a>-to-<a href="/en/developer-guide#term-satoshi" title="The smallest unit of Bitcoin value; 0.00000001 bitcoins.  Also used generically for any value of bitcoins" class="auto-link">satoshis</a> exchange rate, you probably want to
base this on a delta from the time you got the exchange rate. </p>

  <div class="highlight"><pre><code class="python"><span class="n">request</span><span class="o">.</span><span class="n">serialized_payment_details</span> <span class="o">=</span> <span class="n">details</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">()</span>
</code></pre>
</div>

  <p><code>serialized_payment_details</code>: (required) we’ve now set everything we need to create the
<a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" class="auto-link">PaymentDetails</a>, so we’ll use the SerializeToString function from the
<a href="https://developers.google.com/protocol-buffers/" class="auto-link">protocol buffer</a> code to store the <a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" class="auto-link">PaymentDetails</a> in the appropriate
field of the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>.</p>

  <div class="highlight"><pre><code class="python"><span class="n">request</span><span class="o">.</span><span class="n">pki_data</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">()</span>
</code></pre>
</div>

  <p><code>pki_data</code>: (required for signed <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequests</a>) serialize the <a href="/en/developer-examples#term-certificate-chain" title="A chain of certificates connecting a individual's leaf certificate to the certificate authority's root certificate" class="auto-link">certificate chain</a>
<a href="/en/developer-examples#term-pp-pki-data" title="The pki_data field of a PaymentRequest which provides details such as certificates necessary to validate the request" id="term-pp-pki-data" class="term">PKI data</a> and store it in the
<a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a></p>

  <div class="highlight"><pre><code class="python"><span class="n">request</span><span class="o">.</span><span class="n">signature</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</code></pre>
</div>

  <p>We’ve filled out everything in the <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a> except the <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signature</a>,
but before we sign it, we have to initialize the <a href="/en/developer-guide#term-signature" title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" class="auto-link">signature</a> field by
setting it to a zero-byte placeholder.</p>

  <div class="highlight"><pre><code class="python"><span class="n">request</span><span class="o">.</span><span class="n">signature</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">(),</span> <span class="s">&quot;sha256&quot;</span><span class="p">)</span>
</code></pre>
</div>

  <p><code>signature</code>: (required for signed <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequests</a>) now we
make the <a href="/en/developer-examples#term-ssl-signature" title="Signatures created and recognized by major SSL implementations such as OpenSSL" id="term-ssl-signature" class="term">signature</a> by
signing the completed and serialized <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a>. We’ll use the
<a href="/en/developer-guide#term-private-key" title="The private portion of a keypair which can create signatures which other people can verify using the public key" class="auto-link">private key</a> we stored in memory in the configuration section and the
same hashing formula we specified in <a href="/en/developer-examples#term-pp-pki-type" title="The PKI field of a PaymentRequest which tells spenders how to validate this request as being from a specific recipient" class="auto-link"><code>pki_type</code></a> (sha256 in this case) </p>

  <h5 id="output-code">Output Code</h5>

  <p>Now that we have <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a> all filled out, we can serialize it and
send it along with the HTTP headers, as shown in the code below.</p>

  <div class="highlight"><pre><code class="python"><span class="k">print</span> <span class="s">&quot;Content-Type: application/bitcoin-paymentrequest&quot;</span>
<span class="k">print</span> <span class="s">&quot;Content-Transfer-Encoding: binary&quot;</span>
<span class="k">print</span> <span class="s">&quot;&quot;</span>
</code></pre>
</div>

  <p>(Required) <a href="https://github.com/bitcoin/bips/blob/master/bip-0071.mediawiki" class="auto-link">BIP71</a> defines the content types for <a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequests</a>,
Payments, and PaymentACKs.</p>

  <div class="highlight"><pre><code class="python"><span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">())</span>
</code></pre>
</div>

  <p><code>request</code>: (required) now, to finish, we just dump out the serialized
<a href="/en/developer-examples#term-paymentrequest" title="The PaymentRequest of the payment protocol which contains and allows signing of the PaymentDetails" class="auto-link">PaymentRequest</a> (which contains the serialized <a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" class="auto-link">PaymentDetails</a>). The
serialized data is in binary, so we can’t use Python’s print()
because it would add an extraneous newline.</p>

  <p>The following screenshot shows how the authenticated <a href="/en/developer-examples#term-paymentdetails" title="The PaymentDetails of the payment protocol which allows the receiver to specify the payment details to the spender" class="auto-link">PaymentDetails</a>
created by the program above appears in the GUI from Bitcoin Core 0.9.</p>

  <p><img src="/img/dev/en-btcc-payment-request.png" alt="Bitcoin Core Showing Validated Payment Request" /></p>

</div>

<script>updateToc();</script>

<script>addAnchorLinks();</script>


    </div>
    <div class="footer">
    <div class="footermenu">
    <a href="/en/alerts">Network Status</a>
    
    <a href="/en/legal">Legal</a>
    
    
    <a href="/en/about-us">About bitcoin.org</a>
    
    </div>
    <span>© Bitcoin Project 2009-2014 Released under the <a href="http://opensource.org/licenses/mit-license.php" target="_blank">MIT license</a></span>
    </div>
  </div>
  <div class="sponsor-banner">
    
    <div><span>A community website sponsored by</span> <a href="https://bitcoinfoundation.org/"><img src="/img/brand/bitcoinfoundation.png" alt="Bitcoin Foundation"></a></div>
    
  </div>
  <script type="text/javascript">fallbackSVG();</script>
</body>

</html>
